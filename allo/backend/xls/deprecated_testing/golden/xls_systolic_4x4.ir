package xls_systolic_4x4

file_number 0 "/scratch/users/zrs29/xls/xls/xls/dslx/stdlib/std.x"
file_number 1 "/scratch/users/zrs29/xls/xls/xls/dslx/stdlib/apfloat.x"
file_number 2 "/scratch/users/zrs29/xls/xls/xls/dslx/stdlib/float32.x"
file_number 3 "xls_systolic_4x4.x"
file_number 4 "/scratch/users/zrs29/xls/xls/xls/dslx/stdlib/abs_diff.x"

chan xls_systolic_4x4__weights((bits[1], bits[8], bits[23])[4][4], id=0, kind=streaming, ops=receive_only, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__activations__0((bits[1], bits[8], bits[23]), id=1, kind=streaming, ops=receive_only, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__activations__1((bits[1], bits[8], bits[23]), id=2, kind=streaming, ops=receive_only, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__activations__2((bits[1], bits[8], bits[23]), id=3, kind=streaming, ops=receive_only, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__activations__3((bits[1], bits[8], bits[23]), id=4, kind=streaming, ops=receive_only, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__results__0((bits[1], bits[8], bits[23]), id=5, kind=streaming, ops=send_only, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__results__1((bits[1], bits[8], bits[23]), id=6, kind=streaming, ops=send_only, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__results__2((bits[1], bits[8], bits[23]), id=7, kind=streaming, ops=send_only, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__results__3((bits[1], bits[8], bits[23]), id=8, kind=streaming, ops=send_only, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__node_weights__0_0((bits[1], bits[8], bits[23]), id=9, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__node_weights__1_0((bits[1], bits[8], bits[23]), id=10, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__node_weights__2_0((bits[1], bits[8], bits[23]), id=11, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__node_weights__3_0((bits[1], bits[8], bits[23]), id=12, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__node_weights__0_1((bits[1], bits[8], bits[23]), id=13, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__node_weights__1_1((bits[1], bits[8], bits[23]), id=14, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__node_weights__2_1((bits[1], bits[8], bits[23]), id=15, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__node_weights__3_1((bits[1], bits[8], bits[23]), id=16, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__node_weights__0_2((bits[1], bits[8], bits[23]), id=17, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__node_weights__1_2((bits[1], bits[8], bits[23]), id=18, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__node_weights__2_2((bits[1], bits[8], bits[23]), id=19, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__node_weights__3_2((bits[1], bits[8], bits[23]), id=20, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__node_weights__0_3((bits[1], bits[8], bits[23]), id=21, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__node_weights__1_3((bits[1], bits[8], bits[23]), id=22, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__node_weights__2_3((bits[1], bits[8], bits[23]), id=23, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__node_weights__3_3((bits[1], bits[8], bits[23]), id=24, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__east_west__0_0((bits[1], bits[8], bits[23]), id=25, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__east_west__1_0((bits[1], bits[8], bits[23]), id=26, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__east_west__2_0((bits[1], bits[8], bits[23]), id=27, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__east_west__3_0((bits[1], bits[8], bits[23]), id=28, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__east_west__0_1((bits[1], bits[8], bits[23]), id=29, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__east_west__1_1((bits[1], bits[8], bits[23]), id=30, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__east_west__2_1((bits[1], bits[8], bits[23]), id=31, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__east_west__3_1((bits[1], bits[8], bits[23]), id=32, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__east_west__0_2((bits[1], bits[8], bits[23]), id=33, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__east_west__1_2((bits[1], bits[8], bits[23]), id=34, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__east_west__2_2((bits[1], bits[8], bits[23]), id=35, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__east_west__3_2((bits[1], bits[8], bits[23]), id=36, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__east_west__0_3((bits[1], bits[8], bits[23]), id=37, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__east_west__1_3((bits[1], bits[8], bits[23]), id=38, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__east_west__2_3((bits[1], bits[8], bits[23]), id=39, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__east_west__3_3((bits[1], bits[8], bits[23]), id=40, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__east_west__0_4((bits[1], bits[8], bits[23]), id=41, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__east_west__1_4((bits[1], bits[8], bits[23]), id=42, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__east_west__2_4((bits[1], bits[8], bits[23]), id=43, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__east_west__3_4((bits[1], bits[8], bits[23]), id=44, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__north_south__0_0((bits[1], bits[8], bits[23]), id=45, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__north_south__1_0((bits[1], bits[8], bits[23]), id=46, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__north_south__2_0((bits[1], bits[8], bits[23]), id=47, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__north_south__3_0((bits[1], bits[8], bits[23]), id=48, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__north_south__4_0((bits[1], bits[8], bits[23]), id=49, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__north_south__0_1((bits[1], bits[8], bits[23]), id=50, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__north_south__1_1((bits[1], bits[8], bits[23]), id=51, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__north_south__2_1((bits[1], bits[8], bits[23]), id=52, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__north_south__3_1((bits[1], bits[8], bits[23]), id=53, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__north_south__4_1((bits[1], bits[8], bits[23]), id=54, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__north_south__0_2((bits[1], bits[8], bits[23]), id=55, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__north_south__1_2((bits[1], bits[8], bits[23]), id=56, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__north_south__2_2((bits[1], bits[8], bits[23]), id=57, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__north_south__3_2((bits[1], bits[8], bits[23]), id=58, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__north_south__4_2((bits[1], bits[8], bits[23]), id=59, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__north_south__0_3((bits[1], bits[8], bits[23]), id=60, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__north_south__1_3((bits[1], bits[8], bits[23]), id=61, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__north_south__2_3((bits[1], bits[8], bits[23]), id=62, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__north_south__3_3((bits[1], bits[8], bits[23]), id=63, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)
chan xls_systolic_4x4__north_south__4_3((bits[1], bits[8], bits[23]), id=64, kind=streaming, ops=send_receive, flow_control=ready_valid, strictness=proven_mutually_exclusive)

fn __std__mask_bits__8() -> bits[8] {
  literal.2: bits[8] = literal(value=0, id=2, pos=[(0,835,41)])
  X: bits[32] = literal(value=8, id=1, pos=[(0,835,17)])
  ret not.3: bits[8] = not(literal.2, id=3, pos=[(0,835,40)])
}

fn __apfloat__qnan__8_23() -> (bits[1], bits[8], bits[23]) {
  FRACTION_SZ: bits[32] = literal(value=23, id=5, pos=[(1,50,25)])
  literal.10: bits[32] = literal(value=1, id=10, pos=[(1,54,57)])
  sub.11: bits[32] = sub(FRACTION_SZ, literal.10, id=11, pos=[(1,54,43)])
  invoke.7: bits[8] = invoke(to_apply=__std__mask_bits__8, id=7, pos=[(1,53,28)])
  literal.9: bits[23] = literal(value=1, id=9, pos=[(1,54,18)])
  bit_slice.12: bits[23] = bit_slice(sub.11, start=0, width=23, id=12)
  literal.6: bits[1] = literal(value=0, id=6, pos=[(1,52,14)])
  zero_ext.8: bits[8] = zero_ext(invoke.7, new_bit_count=8, id=8)
  shll.13: bits[23] = shll(literal.9, bit_slice.12, id=13, pos=[(1,54,18)])
  EXP_SZ: bits[32] = literal(value=8, id=4, pos=[(1,50,12)])
  ret tuple.14: (bits[1], bits[8], bits[23]) = tuple(literal.6, zero_ext.8, shll.13, id=14, pos=[(1,51,33)])
}

fn __float32__qnan() -> (bits[1], bits[8], bits[23]) {
  F32_EXP_SZ: bits[32] = literal(value=8, id=15, pos=[(2,18,23)])
  F32_FRACTION_SZ: bits[32] = literal(value=23, id=16, pos=[(2,19,28)])
  ret invoke.17: (bits[1], bits[8], bits[23]) = invoke(to_apply=__apfloat__qnan__8_23, id=17, pos=[(2,27,36)])
}

fn __xls_systolic_4x4__node.init__0_0() -> (bits[1], (bits[1], bits[8], bits[23])) {
  literal.20: bits[1] = literal(value=0, id=20, pos=[(3,35,39)])
  invoke.21: (bits[1], bits[8], bits[23]) = invoke(to_apply=__float32__qnan, id=21, pos=[(3,35,67)])
  ROW: bits[32] = literal(value=0, id=18, pos=[(3,23,10)])
  COL: bits[32] = literal(value=0, id=19, pos=[(3,23,20)])
  ret tuple.22: (bits[1], (bits[1], bits[8], bits[23])) = tuple(literal.20, invoke.21, id=22, pos=[(3,35,22)])
}

fn __apfloat__is_zero_or_subnormal__8_23(x: (bits[1], bits[8], bits[23]) id=23) -> bits[1] {
  x_bexp: bits[8] = tuple_index(x, index=1, id=26, pos=[(1,804,5)])
  literal.27: bits[8] = literal(value=0, id=27, pos=[(1,804,14)])
  EXP_SZ: bits[32] = literal(value=8, id=24, pos=[(1,802,28)])
  FRACTION_SZ: bits[32] = literal(value=23, id=25, pos=[(1,802,41)])
  ret eq.28: bits[1] = eq(x_bexp, literal.27, id=28, pos=[(1,804,5)])
}

fn __std__umul__24_24_48(x: bits[24] id=29, y: bits[24] id=30) -> bits[48] {
  zero_ext.34: bits[48] = zero_ext(x, new_bit_count=48, id=34)
  zero_ext.35: bits[48] = zero_ext(y, new_bit_count=48, id=35)
  N: bits[32] = literal(value=24, id=31, pos=[(0,223,12)])
  M: bits[32] = literal(value=24, id=32, pos=[(0,223,20)])
  R: bits[32] = literal(value=48, id=33, pos=[(0,223,28)])
  ret umul.36: bits[48] = umul(zero_ext.34, zero_ext.35, id=36, pos=[(0,224,5)])
}

fn __std__msb__48_0(x: bits[48] id=37) -> bits[1] {
  zero_ext.40: bits[48] = zero_ext(x, new_bit_count=48, id=40)
  S: bits[1] = literal(value=0, id=38, pos=[(0,357,11)])
  N: bits[32] = literal(value=48, id=39, pos=[(0,357,20)])
  ret bit_slice.41: bits[1] = bit_slice(zero_ext.40, start=47, width=1, id=41, pos=[(0,357,61)])
}

fn __apfloat__is_inf__8_23(x: (bits[1], bits[8], bits[23]) id=42) -> bits[1] {
  x_bexp: bits[8] = tuple_index(x, index=1, id=45, pos=[(1,96,6)])
  invoke.46: bits[8] = invoke(to_apply=__std__mask_bits__8, id=46, pos=[(1,96,29)])
  x_fraction: bits[23] = tuple_index(x, index=2, id=48, pos=[(1,96,44)])
  literal.49: bits[23] = literal(value=0, id=49, pos=[(1,96,57)])
  eq.47: bits[1] = eq(x_bexp, invoke.46, id=47, pos=[(1,96,6)])
  eq.50: bits[1] = eq(x_fraction, literal.49, id=50, pos=[(1,96,44)])
  EXP_SZ: bits[32] = literal(value=8, id=43, pos=[(1,95,14)])
  FRACTION_SZ: bits[32] = literal(value=23, id=44, pos=[(1,95,27)])
  ret and.51: bits[1] = and(eq.47, eq.50, id=51, pos=[(1,96,6)])
}

fn __std__signed_max_value__10_9() -> bits[10] {
  literal.54: bits[10] = literal(value=1, id=54, pos=[(0,47,6)])
  N_MINUS_ONE: bits[32] = literal(value=9, id=53, pos=[(0,46,32)])
  shll.55: bits[10] = shll(literal.54, N_MINUS_ONE, id=55, pos=[(0,47,6)])
  literal.56: bits[10] = literal(value=1, id=56, pos=[(0,47,32)])
  sub.57: bits[10] = sub(shll.55, literal.56, id=57, pos=[(0,47,6)])
  N: bits[32] = literal(value=10, id=52, pos=[(0,46,24)])
  ret sign_ext.58: bits[10] = sign_ext(sub.57, new_bit_count=10, id=58)
}

fn __apfloat__is_nan__8_23(x: (bits[1], bits[8], bits[23]) id=59) -> bits[1] {
  x_bexp: bits[8] = tuple_index(x, index=1, id=62, pos=[(1,71,6)])
  invoke.63: bits[8] = invoke(to_apply=__std__mask_bits__8, id=63, pos=[(1,71,29)])
  x_fraction: bits[23] = tuple_index(x, index=2, id=65, pos=[(1,71,44)])
  literal.66: bits[23] = literal(value=0, id=66, pos=[(1,71,57)])
  eq.64: bits[1] = eq(x_bexp, invoke.63, id=64, pos=[(1,71,6)])
  ne.67: bits[1] = ne(x_fraction, literal.66, id=67, pos=[(1,71,44)])
  EXP_SZ: bits[32] = literal(value=8, id=60, pos=[(1,70,14)])
  FRACTION_SZ: bits[32] = literal(value=23, id=61, pos=[(1,70,27)])
  ret and.68: bits[1] = and(eq.64, ne.67, id=68, pos=[(1,71,6)])
}

fn __apfloat__raw_mul__8_23_23_10_48(x: (bits[1], bits[8], bits[23]) id=69, y: (bits[1], bits[8], bits[23]) id=70) -> (bits[1], bits[1], bits[10], bits[48]) {
  literal.79: bits[1] = literal(value=1, id=79, pos=[(1,3434,24)])
  x_fraction: bits[23] = tuple_index(x, index=2, id=80, pos=[(1,3434,33)])
  literal.82: bits[1] = literal(value=1, id=82, pos=[(1,3435,24)])
  y_fraction: bits[23] = tuple_index(y, index=2, id=83, pos=[(1,3435,33)])
  x_bexp: bits[8] = tuple_index(x, index=1, id=92, pos=[(1,3448,16)])
  y_bexp: bits[8] = tuple_index(y, index=1, id=94, pos=[(1,3448,45)])
  invoke.88: bits[8] = invoke(to_apply=__std__mask_bits__8, id=88, pos=[(1,3447,29)])
  invoke.76: bits[1] = invoke(x, to_apply=__apfloat__is_zero_or_subnormal__8_23, id=76, pos=[(1,3431,40)])
  invoke.77: bits[1] = invoke(y, to_apply=__apfloat__is_zero_or_subnormal__8_23, id=77, pos=[(1,3431,67)])
  x_significand: bits[24] = concat(literal.79, x_fraction, id=81, pos=[(1,3434,24)])
  y_significand: bits[24] = concat(literal.82, y_fraction, id=84, pos=[(1,3435,24)])
  zero_ext.93: bits[10] = zero_ext(x_bexp, new_bit_count=10, id=93)
  zero_ext.95: bits[10] = zero_ext(y_bexp, new_bit_count=10, id=95)
  zero_ext.89: bits[10] = zero_ext(invoke.88, new_bit_count=10, id=89)
  literal.90: bits[10] = literal(value=1, id=90, pos=[(1,3447,61)])
  has_0_arg: bits[1] = or(invoke.76, invoke.77, id=78, pos=[(1,3431,40)])
  invoke.86: bits[48] = invoke(x_significand, y_significand, to_apply=__std__umul__24_24_48, id=86, pos=[(1,3439,61)])
  literal.85: bits[48] = literal(value=0, id=85, pos=[(1,3439,23)])
  add.96: bits[10] = add(zero_ext.93, zero_ext.95, id=96, pos=[(1,3448,16)])
  bias: bits[10] = shra(zero_ext.89, literal.90, id=91, pos=[(1,3447,29)])
  full_product: bits[48] = sel(has_0_arg, cases=[invoke.86, literal.85], id=87, pos=[(1,3439,8)])
  invoke.119: bits[1] = invoke(x, to_apply=__apfloat__is_inf__8_23, id=119, pos=[(1,3488,28)])
  invoke.120: bits[1] = invoke(y, to_apply=__apfloat__is_inf__8_23, id=120, pos=[(1,3488,41)])
  exp: bits[10] = sub(add.96, bias, id=97, pos=[(1,3448,16)])
  literal.98: bits[10] = literal(value=0, id=98, pos=[(1,3457,29)])
  in_upper_binade: bits[1] = invoke(full_product, to_apply=__std__msb__48_0, id=100, pos=[(1,3463,34)])
  literal.101: bits[1] = literal(value=1, id=101, pos=[(1,3464,90)])
  invoke.116: bits[1] = invoke(x, to_apply=__apfloat__is_nan__8_23, id=116, pos=[(1,3487,28)])
  invoke.117: bits[1] = invoke(y, to_apply=__apfloat__is_nan__8_23, id=117, pos=[(1,3487,41)])
  has_inf_arg: bits[1] = or(invoke.119, invoke.120, id=121, pos=[(1,3488,28)])
  invoke.109: bits[1] = invoke(x, to_apply=__apfloat__is_inf__8_23, id=109, pos=[(1,3481,31)])
  invoke.110: bits[1] = invoke(y, to_apply=__apfloat__is_inf__8_23, id=110, pos=[(1,3481,44)])
  exp__1: bits[10] = sel(has_0_arg, cases=[exp, literal.98], id=99, pos=[(1,3457,14)])
  zero_ext.104: bits[10] = zero_ext(in_upper_binade, new_bit_count=10, id=104)
  shll.102: bits[48] = shll(full_product, literal.101, id=102, pos=[(1,3464,74)])
  has_nan_arg: bits[1] = or(invoke.116, invoke.117, id=118, pos=[(1,3487,28)])
  and.122: bits[1] = and(has_0_arg, has_inf_arg, id=122, pos=[(1,3489,40)])
  x_sign: bits[1] = tuple_index(x, index=0, id=106, pos=[(1,3471,23)])
  y_sign: bits[1] = tuple_index(y, index=0, id=107, pos=[(1,3471,33)])
  is_operand_inf: bits[1] = or(invoke.109, invoke.110, id=111, pos=[(1,3481,31)])
  result_exp: bits[10] = add(exp__1, zero_ext.104, id=105, pos=[(1,3468,14)])
  invoke.112: bits[10] = invoke(to_apply=__std__signed_max_value__10_9, id=112, pos=[(1,3482,62)])
  result_fraction: bits[48] = sel(in_upper_binade, cases=[shll.102, full_product], id=103, pos=[(1,3464,30)])
  literal.114: bits[48] = literal(value=0, id=114, pos=[(1,3483,46)])
  is_result_nan: bits[1] = or(has_nan_arg, and.122, id=123, pos=[(1,3489,24)])
  result_sign: bits[1] = ne(x_sign, y_sign, id=108, pos=[(1,3471,23)])
  result_exp__1: bits[10] = sel(is_operand_inf, cases=[result_exp, invoke.112], id=113, pos=[(1,3482,21)])
  result_fraction__1: bits[48] = sel(is_operand_inf, cases=[result_fraction, literal.114], id=115, pos=[(1,3483,26)])
  EXP_SZ: bits[32] = literal(value=8, id=71, pos=[(1,3426,5)])
  FRACTION_SZ_X: bits[32] = literal(value=23, id=72, pos=[(1,3426,18)])
  FRACTION_SZ_Y: bits[32] = literal(value=23, id=73, pos=[(1,3426,38)])
  SIGNED_EXP: bits[32] = literal(value=10, id=74, pos=[(1,3426,58)])
  WIDE_FRACTION: bits[32] = literal(value=48, id=75, pos=[(1,3427,5)])
  ret tuple.124: (bits[1], bits[1], bits[10], bits[48]) = tuple(is_result_nan, result_sign, result_exp__1, result_fraction__1, id=124, pos=[(1,3491,42)])
}

fn __std__mask_bits__9() -> bits[9] {
  literal.126: bits[9] = literal(value=0, id=126, pos=[(0,835,41)])
  X: bits[32] = literal(value=9, id=125, pos=[(0,835,17)])
  ret not.127: bits[9] = not(literal.126, id=127, pos=[(0,835,40)])
}

fn __apfloat__mul_no_round__9_10_8_23_48(a: (bits[1], bits[8], bits[23]) id=128, b: (bits[1], bits[8], bits[23]) id=129) -> (bits[1], bits[9], bits[48]) {
  raw_product: (bits[1], bits[1], bits[10], bits[48]) = invoke(a, b, to_apply=__apfloat__raw_mul__8_23_23_10_48, id=135, pos=[(1,3574,29)])
  raw_product_bexp__2: bits[10] = tuple_index(raw_product, index=2, id=144, pos=[(1,3583,45)])
  neg.145: bits[10] = neg(raw_product_bexp__2, id=145, pos=[(1,3583,33)])
  raw_product_bexp: bits[10] = tuple_index(raw_product, index=2, id=136, pos=[(1,3580,34)])
  literal.137: bits[10] = literal(value=0, id=137, pos=[(1,3580,43)])
  raw_product_bexp__1: bits[10] = tuple_index(raw_product, index=2, id=140, pos=[(1,3581,75)])
  raw_product_fraction: bits[48] = tuple_index(raw_product, index=3, id=143, pos=[(1,3583,19)])
  bit_slice.146: bits[9] = bit_slice(neg.145, start=0, width=9, id=146)
  is_subnormal: bits[1] = sle(raw_product_bexp, literal.137, id=138, pos=[(1,3580,34)])
  bit_slice.141: bits[9] = bit_slice(raw_product_bexp__1, start=0, width=9, id=141)
  literal.139: bits[9] = literal(value=0, id=139, pos=[(1,3581,39)])
  raw_product_fraction__1: bits[48] = tuple_index(raw_product, index=3, id=148, pos=[(1,3585,19)])
  shrl.147: bits[48] = shrl(raw_product_fraction, bit_slice.146, id=147, pos=[(1,3583,19)])
  literal.153: bits[2] = literal(value=3, id=153, pos=[(1,3593,22)])
  literal.154: bits[46] = literal(value=0, id=154, pos=[(1,3593,30)])
  raw_product_sign: bits[1] = tuple_index(raw_product, index=1, id=157, pos=[(1,3596,35)])
  result_exp: bits[9] = sel(is_subnormal, cases=[bit_slice.141, literal.139], id=142, pos=[(1,3581,21)])
  result_fraction: bits[48] = sel(is_subnormal, cases=[raw_product_fraction__1, shrl.147], id=149, pos=[(1,3582,26)])
  literal.151: bits[1] = literal(value=0, id=151, pos=[(1,3591,18)])
  invoke.152: bits[9] = invoke(to_apply=__std__mask_bits__9, id=152, pos=[(1,3592,32)])
  concat.155: bits[48] = concat(literal.153, literal.154, id=155, pos=[(1,3593,22)])
  raw_product_is_nan: bits[1] = tuple_index(raw_product, index=0, id=150, pos=[(1,3588,18)])
  tuple.158: (bits[1], bits[9], bits[48]) = tuple(raw_product_sign, result_exp, result_fraction, id=158, pos=[(1,3596,16)])
  tuple.156: (bits[1], bits[9], bits[48]) = tuple(literal.151, invoke.152, concat.155, id=156, pos=[(1,3590,16)])
  EXP_SZ: bits[32] = literal(value=8, id=130, pos=[(1,3570,5)])
  FRACTION_SZ: bits[32] = literal(value=23, id=131, pos=[(1,3570,18)])
  WIDE_FRACTION: bits[32] = literal(value=48, id=132, pos=[(1,3570,36)])
  EXP_CARRY: bits[32] = literal(value=9, id=133, pos=[(1,3571,5)])
  EXP_SIGN_CARRY: bits[32] = literal(value=10, id=134, pos=[(1,3571,40)])
  ret sel.159: (bits[1], bits[9], bits[48]) = sel(raw_product_is_nan, cases=[tuple.158, tuple.156], id=159, pos=[(1,3588,4)])
}

fn __std__uadd_with_overflow__9_9_9_9_9(x: bits[9] id=160, y: bits[9] id=161) -> (bits[1], bits[9]) {
  x_extended: bits[10] = zero_ext(x, new_bit_count=10, id=167)
  y_extended: bits[10] = zero_ext(y, new_bit_count=10, id=168)
  full_result: bits[10] = add(x_extended, y_extended, id=169, pos=[(0,1119,45)])
  bit_slice.171: bits[1] = bit_slice(full_result, start=9, width=1, id=171, pos=[(0,1121,49)])
  overflow_detected: bits[1] = or_reduce(bit_slice.171, id=172, pos=[(0,1121,37)])
  narrowed_result: bits[9] = bit_slice(full_result, start=0, width=9, id=170)
  V: bits[32] = literal(value=9, id=162, pos=[(0,1113,5)])
  N: bits[32] = literal(value=9, id=163, pos=[(0,1113,13)])
  M: bits[32] = literal(value=9, id=164, pos=[(0,1113,21)])
  MAX_N_M: bits[32] = literal(value=9, id=165, pos=[(0,1113,29)])
  MAX_N_M_V: bits[32] = literal(value=9, id=166, pos=[(0,1113,57)])
  ret tuple.173: (bits[1], bits[9]) = tuple(overflow_detected, narrowed_result, id=173, pos=[(0,1123,4)])
}

fn __abs_diff__abs_diff__9(x: bits[9] id=174, y: bits[9] id=175) -> (bits[1], bits[9]) {
  ynot: bits[9] = not(y, id=177, pos=[(4,90,15)])
  invoke.178: (bits[1], bits[9]) = invoke(x, ynot, to_apply=__std__uadd_with_overflow__9_9_9_9_9, id=178, pos=[(4,91,63)])
  carry_out: bits[1] = tuple_index(invoke.178, index=0, id=179, pos=[(4,91,9)])
  nc: bits[1] = not(carry_out, id=181, pos=[(4,92,19)])
  z: bits[9] = tuple_index(invoke.178, index=1, id=180, pos=[(4,91,20)])
  xor_mask: bits[9] = sign_ext(nc, new_bit_count=9, id=183, pos=[(4,94,32)])
  result: bits[9] = xor(z, xor_mask, id=184, pos=[(4,95,18)])
  N: bits[32] = literal(value=9, id=176, pos=[(4,89,16)])
  literal.182: bits[9] = literal(value=0, id=182, pos=[(4,94,42)])
  ret tuple.185: (bits[1], bits[9]) = tuple(carry_out, result, id=185, pos=[(4,96,18)])
}

fn __abs_diff__is_x_larger__9(adr: (bits[1], bits[9]) id=186) -> bits[1] {
  N: bits[32] = literal(value=9, id=187, pos=[(4,47,19)])
  ret adr_correction: bits[1] = tuple_index(adr, index=0, id=188, pos=[(4,47,63)])
}

fn __abs_diff__to_corrected__9(adr: (bits[1], bits[9]) id=189) -> bits[9] {
  adr_correction: bits[1] = tuple_index(adr, index=0, id=192, pos=[(4,54,25)])
  adr_uncorrected: bits[9] = tuple_index(adr, index=1, id=191, pos=[(4,54,7)])
  zero_ext.193: bits[9] = zero_ext(adr_correction, new_bit_count=9, id=193)
  N: bits[32] = literal(value=9, id=190, pos=[(4,53,20)])
  ret add.194: bits[9] = add(adr_uncorrected, zero_ext.193, id=194, pos=[(4,54,7)])
}

fn __apfloat__sign_magnitude_difference__9(a: bits[9] id=195, b: bits[9] id=196) -> (bits[1], bits[9]) {
  abs_diff_result: (bits[1], bits[9]) = invoke(a, b, to_apply=__abs_diff__abs_diff__9, id=198, pos=[(1,3009,44)])
  invoke.199: bits[1] = invoke(abs_diff_result, to_apply=__abs_diff__is_x_larger__9, id=199, pos=[(1,3010,27)])
  not.200: bits[1] = not(invoke.199, id=200, pos=[(1,3010,5)])
  invoke.201: bits[9] = invoke(abs_diff_result, to_apply=__abs_diff__to_corrected__9, id=201, pos=[(1,3010,68)])
  WIDTH: bits[32] = literal(value=9, id=197, pos=[(1,3008,29)])
  ret tuple.202: (bits[1], bits[9]) = tuple(not.200, invoke.201, id=202, pos=[(1,3010,4)])
}

fn __std__keep_lsbs__9_73(x: bits[73] id=203, n: bits[9] id=204) -> bits[73] {
  literal.207: bits[73] = literal(value=0x1ff_ffff_ffff_ffff_ffff, id=207, pos=[(0,1411,19)])
  shll.208: bits[73] = shll(literal.207, n, id=208, pos=[(0,1411,19)])
  not.209: bits[73] = not(shll.208, id=209, pos=[(0,1411,8)])
  WIDTH: bits[32] = literal(value=73, id=205, pos=[(0,1410,17)])
  N_WIDTH: bits[32] = literal(value=9, id=206, pos=[(0,1410,29)])
  ret and.210: bits[73] = and(x, not.209, id=210, pos=[(0,1411,4)])
}

fn __std__or_reduce_lsb_impl__1_9_73(value: bits[73] id=211, n: bits[9] id=212) -> bits[1] {
  WIDTH: bits[32] = literal(value=73, id=214, pos=[(0,1497,42)])
  bit_slice.219: bits[9] = bit_slice(WIDTH, start=0, width=9, id=219)
  sub.220: bits[9] = sub(bit_slice.219, n, id=220, pos=[(0,1504,18)])
  shll.221: bits[73] = shll(value, sub.220, id=221, pos=[(0,1504,8)])
  literal.222: bits[73] = literal(value=0x0, id=222, pos=[(0,1504,47)])
  invoke.216: bits[73] = invoke(value, n, to_apply=__std__keep_lsbs__9_73, id=216, pos=[(0,1501,17)])
  literal.217: bits[73] = literal(value=0x0, id=217, pos=[(0,1501,31)])
  DO_MASK_IMPL: bits[1] = literal(value=1, id=213, pos=[(0,1497,22)])
  ne.223: bits[1] = ne(shll.221, literal.222, id=223, pos=[(0,1504,8)])
  ne.218: bits[1] = ne(invoke.216, literal.217, id=218, pos=[(0,1501,17)])
  N_WIDTH: bits[32] = literal(value=9, id=215, pos=[(0,1497,54)])
  ret sel.224: bits[1] = sel(DO_MASK_IMPL, cases=[ne.223, ne.218], id=224, pos=[(0,1499,4)])
}

fn __std__or_reduce_lsb__9_73(value: bits[73] id=225, n: bits[9] id=226) -> bits[1] {
  WIDTH: bits[32] = literal(value=73, id=227, pos=[(0,1527,21)])
  N_WIDTH: bits[32] = literal(value=9, id=228, pos=[(0,1527,33)])
  ret invoke.229: bits[1] = invoke(value, n, to_apply=__std__or_reduce_lsb_impl__1_9_73, id=229, pos=[(0,1528,22)])
}

fn __apfloat__is_product_inf__9_48(p: (bits[1], bits[9], bits[48]) id=230) -> bits[1] {
  p_bexp: bits[9] = tuple_index(p, index=1, id=233, pos=[(1,3550,5)])
  invoke.234: bits[9] = invoke(to_apply=__std__mask_bits__9, id=234, pos=[(1,3550,28)])
  p_fraction: bits[48] = tuple_index(p, index=2, id=236, pos=[(1,3550,46)])
  literal.237: bits[48] = literal(value=0, id=237, pos=[(1,3550,59)])
  eq.235: bits[1] = eq(p_bexp, invoke.234, id=235, pos=[(1,3550,5)])
  eq.238: bits[1] = eq(p_fraction, literal.237, id=238, pos=[(1,3550,46)])
  EXP_CARRY: bits[32] = literal(value=9, id=231, pos=[(1,3548,18)])
  WIDE_FRACTION: bits[32] = literal(value=48, id=232, pos=[(1,3548,34)])
  ret and.239: bits[1] = and(eq.235, eq.238, id=239, pos=[(1,3550,5)])
}

fn __apfloat__is_product_nan__9_48(p: (bits[1], bits[9], bits[48]) id=240) -> bits[1] {
  p_bexp: bits[9] = tuple_index(p, index=1, id=243, pos=[(1,3556,5)])
  invoke.244: bits[9] = invoke(to_apply=__std__mask_bits__9, id=244, pos=[(1,3556,28)])
  p_fraction: bits[48] = tuple_index(p, index=2, id=246, pos=[(1,3556,46)])
  literal.247: bits[48] = literal(value=0, id=247, pos=[(1,3556,59)])
  eq.245: bits[1] = eq(p_bexp, invoke.244, id=245, pos=[(1,3556,5)])
  ne.248: bits[1] = ne(p_fraction, literal.247, id=248, pos=[(1,3556,46)])
  EXP_CARRY: bits[32] = literal(value=9, id=241, pos=[(1,3554,18)])
  WIDE_FRACTION: bits[32] = literal(value=48, id=242, pos=[(1,3554,34)])
  ret and.249: bits[1] = and(eq.245, ne.248, id=249, pos=[(1,3556,5)])
}

fn __itok__apfloat__fma__8_23(__token: token id=250, __activated: bits[1] id=251, a: (bits[1], bits[8], bits[23]) id=252, b: (bits[1], bits[8], bits[23]) id=253, c: (bits[1], bits[8], bits[23]) id=254) -> (token, (bits[1], bits[8], bits[23])) {
  FRACTION_SZ: bits[32] = literal(value=23, id=256, pos=[(1,3614,24)])
  literal.261: bits[32] = literal(value=1, id=261, pos=[(1,3622,46)])
  add.262: bits[32] = add(FRACTION_SZ, literal.261, id=262, pos=[(1,3622,32)])
  literal.263: bits[32] = literal(value=3, id=263, pos=[(1,3622,55)])
  literal.303: bits[32] = literal(value=1, id=303, pos=[(1,3651,79)])
  ab: (bits[1], bits[9], bits[48]) = invoke(a, b, to_apply=__apfloat__mul_no_round__9_10_8_23_48, id=274, pos=[(1,3636,25)])
  c_bexp: bits[8] = tuple_index(c, index=1, id=276, pos=[(1,3639,44)])
  c_fraction: bits[23] = tuple_index(c, index=2, id=291, pos=[(1,3645,18)])
  literal.293: bits[73] = literal(value=0x1, id=293, pos=[(1,3645,52)])
  umul.264: bits[32] = umul(add.262, literal.263, id=264, pos=[(1,3622,32)])
  literal.265: bits[32] = literal(value=1, id=265, pos=[(1,3622,63)])
  add.304: bits[32] = add(FRACTION_SZ, literal.303, id=304, pos=[(1,3651,65)])
  literal.305: bits[32] = literal(value=2, id=305, pos=[(1,3651,88)])
  ab_bexp: bits[9] = tuple_index(ab, index=1, id=275, pos=[(1,3639,36)])
  zero_ext.277: bits[9] = zero_ext(c_bexp, new_bit_count=9, id=277)
  c_bexp__2: bits[8] = tuple_index(c, index=1, id=296, pos=[(1,3646,21)])
  literal.297: bits[8] = literal(value=0, id=297, pos=[(1,3646,30)])
  zero_ext.292: bits[73] = zero_ext(c_fraction, new_bit_count=73, id=292)
  shll.294: bits[73] = shll(literal.293, FRACTION_SZ, id=294, pos=[(1,3645,52)])
  literal.309: bits[32] = literal(value=1, id=309, pos=[(1,3652,59)])
  ab_fraction: bits[48] = tuple_index(ab, index=2, id=301, pos=[(1,3651,11)])
  WIDE_FRACTION: bits[32] = add(umul.264, literal.265, id=266, pos=[(1,3622,32)])
  umul.306: bits[32] = umul(add.304, literal.305, id=306, pos=[(1,3651,65)])
  invoke.278: (bits[1], bits[9]) = invoke(ab_bexp, zero_ext.277, to_apply=__apfloat__sign_magnitude_difference__9, id=278, pos=[(1,3639,33)])
  eq.298: bits[1] = eq(c_bexp__2, literal.297, id=298, pos=[(1,3646,21)])
  wide_c: bits[73] = or(zero_ext.292, shll.294, id=295, pos=[(1,3645,18)])
  literal.299: bits[73] = literal(value=0x0, id=299, pos=[(1,3646,45)])
  add.310: bits[32] = add(FRACTION_SZ, literal.309, id=310, pos=[(1,3652,45)])
  zero_ext.302: bits[73] = zero_ext(ab_fraction, new_bit_count=73, id=302)
  sub.307: bits[32] = sub(WIDE_FRACTION, umul.306, id=307, pos=[(1,3651,47)])
  ab_exp_smaller: bits[1] = tuple_index(invoke.278, index=0, id=279, pos=[(1,3638,9)])
  literal.313: bits[9] = literal(value=0, id=313, pos=[(1,3656,64)])
  exp_difference: bits[9] = tuple_index(invoke.278, index=1, id=280, pos=[(1,3638,25)])
  wide_c__1: bits[73] = sel(eq.298, cases=[wide_c, literal.299], id=300, pos=[(1,3646,17)])
  sub.311: bits[32] = sub(WIDE_FRACTION, add.310, id=311, pos=[(1,3652,28)])
  literal.315: bits[9] = literal(value=0, id=315, pos=[(1,3657,39)])
  c_bexp__1: bits[8] = tuple_index(c, index=1, id=281, pos=[(1,3641,30)])
  wide_ab: bits[73] = shll(zero_ext.302, sub.307, id=308, pos=[(1,3651,11)])
  rshift_ab: bits[9] = sel(ab_exp_smaller, cases=[literal.313, exp_difference], id=314, pos=[(1,3656,20)])
  wide_c__2: bits[73] = shll(wide_c__1, sub.311, id=312, pos=[(1,3652,17)])
  rshift_c: bits[9] = sel(ab_exp_smaller, cases=[exp_difference, literal.315], id=316, pos=[(1,3657,19)])
  ab_bexp__1: bits[9] = tuple_index(ab, index=1, id=285, pos=[(1,3641,74)])
  ab_sign: bits[1] = tuple_index(ab, index=0, id=286, pos=[(1,3641,83)])
  zero_ext.282: bits[9] = zero_ext(c_bexp__1, new_bit_count=9, id=282)
  c_sign: bits[1] = tuple_index(c, index=0, id=283, pos=[(1,3641,55)])
  invoke.319: bits[1] = invoke(wide_ab, rshift_ab, to_apply=__std__or_reduce_lsb__9_73, id=319, pos=[(1,3660,38)])
  invoke.321: bits[1] = invoke(wide_c__2, rshift_c, to_apply=__std__or_reduce_lsb__9_73, id=321, pos=[(1,3661,37)])
  tuple.287: (bits[9], bits[1]) = tuple(ab_bexp__1, ab_sign, id=287, pos=[(1,3641,71)])
  tuple.284: (bits[9], bits[1]) = tuple(zero_ext.282, c_sign, id=284, pos=[(1,3641,28)])
  shifted_ab: bits[73] = shrl(wide_ab, rshift_ab, id=317, pos=[(1,3658,21)])
  sticky_ab: bits[73] = zero_ext(invoke.319, new_bit_count=73, id=320)
  shifted_c: bits[73] = shrl(wide_c__2, rshift_c, id=318, pos=[(1,3659,20)])
  sticky_c: bits[73] = zero_ext(invoke.321, new_bit_count=73, id=322)
  sel.288: (bits[9], bits[1]) = sel(ab_exp_smaller, cases=[tuple.287, tuple.284], id=288, pos=[(1,3641,8)])
  or.323: bits[73] = or(shifted_ab, sticky_ab, id=323, pos=[(1,3664,22)])
  or.325: bits[73] = or(shifted_c, sticky_c, id=325, pos=[(1,3665,21)])
  ab_sign__1: bits[1] = tuple_index(ab, index=0, id=327, pos=[(1,3668,26)])
  greater_sign: bits[1] = tuple_index(sel.288, index=1, id=290, pos=[(1,3640,22)])
  shifted_ab__1: bits[75] = zero_ext(or.323, new_bit_count=75, id=324)
  c_sign__1: bits[1] = tuple_index(c, index=0, id=331, pos=[(1,3669,24)])
  shifted_c__1: bits[75] = zero_ext(or.325, new_bit_count=75, id=326)
  ne.328: bits[1] = ne(ab_sign__1, greater_sign, id=328, pos=[(1,3668,26)])
  neg.329: bits[75] = neg(shifted_ab__1, id=329, pos=[(1,3668,50)])
  ne.332: bits[1] = ne(c_sign__1, greater_sign, id=332, pos=[(1,3669,24)])
  neg.333: bits[75] = neg(shifted_c__1, id=333, pos=[(1,3669,48)])
  shifted_ab__2: bits[75] = sel(ne.328, cases=[shifted_ab__1, neg.329], id=330, pos=[(1,3668,21)])
  shifted_c__2: bits[75] = sel(ne.332, cases=[shifted_c__1, neg.333], id=334, pos=[(1,3669,20)])
  sum_fraction: bits[75] = add(shifted_ab__2, shifted_c__2, id=335, pos=[(1,3672,23)])
  literal.363: bits[75] = literal(value=0x0, id=363, pos=[(1,3681,42)])
  slt.364: bits[1] = slt(sum_fraction, literal.363, id=364, pos=[(1,3681,27)])
  neg.365: bits[75] = neg(sum_fraction, id=365, pos=[(1,3682,27)])
  sel.366: bits[75] = sel(slt.364, cases=[sum_fraction, neg.365], id=366, pos=[(1,3681,24)])
  abs_fraction: bits[74] = bit_slice(sel.366, start=0, width=74, id=367)
  reverse.375: bits[74] = reverse(abs_fraction, id=375, pos=[(1,3695,28)])
  one_hot.376: bits[75] = one_hot(reverse.375, lsb_prio=true, id=376, pos=[(1,3695,28)])
  encode.377: bits[7] = encode(one_hot.376, id=377, pos=[(1,3695,28)])
  leading_zeroes: bits[74] = zero_ext(encode.377, new_bit_count=74, id=378, pos=[(1,3695,28)])
  literal.379: bits[74] = literal(value=0x1, id=379, pos=[(1,3696,34)])
  carry_bit: bits[1] = bit_slice(abs_fraction, start=73, width=1, id=368, pos=[(1,3689,32)])
  cancel: bits[1] = ugt(leading_zeroes, literal.379, id=380, pos=[(1,3696,17)])
  tuple.385: (bits[1], bits[1]) = tuple(carry_bit, cancel, id=385, pos=[(1,3699,33)])
  literal.406: bits[1] = literal(value=0, id=406, pos=[(1,3702,9)])
  tuple_index.405: bits[1] = tuple_index(tuple.385, index=0, id=405)
  literal.397: bits[1] = literal(value=0, id=397, pos=[(1,3701,9)])
  tuple_index.396: bits[1] = tuple_index(tuple.385, index=0, id=396)
  literal.388: bits[1] = literal(value=1, id=388, pos=[(1,3700,9)])
  tuple_index.387: bits[1] = tuple_index(tuple.385, index=0, id=387)
  literal.404: bits[1] = literal(value=1, id=404)
  eq.407: bits[1] = eq(literal.406, tuple_index.405, id=407)
  literal.410: bits[1] = literal(value=0, id=410, pos=[(1,3702,16)])
  tuple_index.409: bits[1] = tuple_index(tuple.385, index=1, id=409)
  literal.395: bits[1] = literal(value=1, id=395)
  eq.398: bits[1] = eq(literal.397, tuple_index.396, id=398)
  literal.401: bits[1] = literal(value=1, id=401, pos=[(1,3701,16)])
  tuple_index.400: bits[1] = tuple_index(tuple.385, index=1, id=400)
  literal.386: bits[1] = literal(value=1, id=386)
  eq.389: bits[1] = eq(literal.388, tuple_index.387, id=389)
  literal.392: bits[1] = literal(value=0, id=392, pos=[(1,3700,15)])
  tuple_index.391: bits[1] = tuple_index(tuple.385, index=1, id=391)
  literal.369: bits[74] = literal(value=0x1, id=369, pos=[(1,3690,42)])
  literal.381: bits[74] = literal(value=0x1, id=381, pos=[(1,3698,43)])
  and.408: bits[1] = and(literal.404, eq.407, id=408)
  eq.411: bits[1] = eq(literal.410, tuple_index.409, id=411)
  and.399: bits[1] = and(literal.395, eq.398, id=399)
  eq.402: bits[1] = eq(literal.401, tuple_index.400, id=402)
  and.390: bits[1] = and(literal.386, eq.389, id=390)
  eq.393: bits[1] = eq(literal.392, tuple_index.391, id=393)
  shrl.370: bits[74] = shrl(abs_fraction, literal.369, id=370, pos=[(1,3690,26)])
  bit_slice.372: bits[1] = bit_slice(abs_fraction, start=0, width=1, id=372, pos=[(1,3691,55)])
  sub.382: bits[74] = sub(leading_zeroes, literal.381, id=382, pos=[(1,3698,26)])
  and.412: bits[1] = and(and.408, eq.411, id=412)
  and.403: bits[1] = and(and.399, eq.402, id=403)
  and.394: bits[1] = and(and.390, eq.393, id=394)
  carry_fraction: bits[73] = bit_slice(shrl.370, start=0, width=73, id=371)
  zero_ext.373: bits[73] = zero_ext(bit_slice.372, new_bit_count=73, id=373)
  shll.383: bits[74] = shll(abs_fraction, sub.382, id=383, pos=[(1,3698,9)])
  literal.416: bits[73] = literal(value=0x0, id=416, pos=[(1,3703,39)])
  concat.422: bits[3] = concat(and.412, and.403, and.394, id=422)
  carry_fraction__1: bits[73] = or(carry_fraction, zero_ext.373, id=374, pos=[(1,3691,25)])
  cancel_fraction: bits[73] = bit_slice(shll.383, start=0, width=73, id=384)
  bit_slice.413: bits[73] = bit_slice(abs_fraction, start=0, width=73, id=413)
  identity.421: bits[73] = identity(literal.416, id=421)
  WIDE_FRACTION_LOW_BIT: bits[32] = sub(WIDE_FRACTION, FRACTION_SZ, id=271, pos=[(1,3630,39)])
  literal.427: bits[32] = literal(value=2, id=427, pos=[(1,3713,85)])
  shifted_fraction: bits[73] = priority_sel(concat.422, cases=[carry_fraction__1, cancel_fraction, bit_slice.413], default=identity.421, id=423)
  literal.426: bits[49] = literal(value=1, id=426, pos=[(1,3713,24)])
  sub.428: bits[32] = sub(WIDE_FRACTION_LOW_BIT, literal.427, id=428, pos=[(1,3713,61)])
  normal_chunk: bits[49] = bit_slice(shifted_fraction, start=0, width=49, id=424, pos=[(1,3710,39)])
  half_of_extra: bits[49] = shll(literal.426, sub.428, id=429, pos=[(1,3713,24)])
  half_way_chunk: bits[2] = bit_slice(shifted_fraction, start=48, width=2, id=425, pos=[(1,3712,24)])
  literal.431: bits[2] = literal(value=3, id=431, pos=[(1,3715,63)])
  literal.439: bits[32] = literal(value=1, id=439, pos=[(1,3718,63)])
  ugt.430: bits[1] = ugt(normal_chunk, half_of_extra, id=430, pos=[(1,3715,12)])
  eq.432: bits[1] = eq(half_way_chunk, literal.431, id=432, pos=[(1,3715,45)])
  literal.438: bits[74] = literal(value=0x1, id=438, pos=[(1,3718,9)])
  sub.440: bits[32] = sub(WIDE_FRACTION_LOW_BIT, literal.439, id=440, pos=[(1,3718,39)])
  or.433: bits[1] = or(ugt.430, eq.432, id=433, pos=[(1,3715,12)])
  literal.435: bits[1] = literal(value=0, id=435, pos=[(1,3715,87)])
  literal.434: bits[1] = literal(value=1, id=434, pos=[(1,3715,73)])
  zero_ext.437: bits[74] = zero_ext(shifted_fraction, new_bit_count=74, id=437)
  shll.441: bits[74] = shll(literal.438, sub.440, id=441, pos=[(1,3718,9)])
  do_round_up: bits[1] = sel(or.433, cases=[literal.435, literal.434], id=436, pos=[(1,3715,8)])
  zero_ext.443: bits[74] = zero_ext(shifted_fraction, new_bit_count=74, id=443)
  add.442: bits[74] = add(zero_ext.437, shll.441, id=442, pos=[(1,3717,8)])
  rounded_fraction: bits[74] = sel(do_round_up, cases=[zero_ext.443, add.442], id=444, pos=[(1,3716,27)])
  greater_exp: bits[9] = tuple_index(sel.288, index=0, id=289, pos=[(1,3640,9)])
  rounding_carry: bits[1] = bit_slice(rounded_fraction, start=73, width=1, id=445, pos=[(1,3723,41)])
  zero_ext.451: bits[10] = zero_ext(greater_exp, new_bit_count=10, id=451)
  zero_ext.452: bits[10] = zero_ext(rounding_carry, new_bit_count=10, id=452)
  add.453: bits[10] = add(zero_ext.451, zero_ext.452, id=453, pos=[(1,3728,15)])
  literal.454: bits[10] = literal(value=1, id=454, pos=[(1,3729,15)])
  literal.336: bits[75] = literal(value=0x0, id=336, pos=[(1,3673,43)])
  literal.338: bits[75] = literal(value=0x0, id=338, pos=[(1,3674,62)])
  add.455: bits[10] = add(add.453, literal.454, id=455, pos=[(1,3728,15)])
  bit_slice.456: bits[10] = bit_slice(leading_zeroes, start=0, width=10, id=456)
  fraction_is_zero: bits[1] = eq(sum_fraction, literal.336, id=337, pos=[(1,3673,27)])
  slt.339: bits[1] = slt(sum_fraction, literal.338, id=339, pos=[(1,3674,47)])
  bexp: bits[10] = sub(add.455, bit_slice.456, id=457, pos=[(1,3728,15)])
  literal.458: bits[10] = literal(value=0, id=458, pos=[(1,3730,37)])
  literal.446: bits[32] = literal(value=1, id=446, pos=[(1,3725,52)])
  tuple.340: (bits[1], bits[1]) = tuple(fraction_is_zero, slt.339, id=340, pos=[(1,3674,28)])
  bexp__1: bits[10] = sel(fraction_is_zero, cases=[bexp, literal.458], id=459, pos=[(1,3730,15)])
  literal.460: bits[10] = literal(value=0, id=460, pos=[(1,3731,25)])
  sub.447: bits[32] = sub(WIDE_FRACTION_LOW_BIT, literal.446, id=447, pos=[(1,3725,28)])
  literal.352: bits[1] = literal(value=0, id=352, pos=[(1,3676,9)])
  tuple_index.351: bits[1] = tuple_index(tuple.340, index=0, id=351)
  literal.343: bits[1] = literal(value=1, id=343, pos=[(1,3675,9)])
  tuple_index.342: bits[1] = tuple_index(tuple.340, index=0, id=342)
  ab_sign__2: bits[1] = tuple_index(ab, index=0, id=485, pos=[(1,3749,47)])
  literal.486: bits[1] = literal(value=0, id=486, pos=[(1,3749,56)])
  c_sign__2: bits[1] = tuple_index(c, index=0, id=490, pos=[(1,3749,80)])
  literal.491: bits[1] = literal(value=0, id=491, pos=[(1,3749,89)])
  ab_sign__3: bits[1] = tuple_index(ab, index=0, id=498, pos=[(1,3754,47)])
  literal.499: bits[1] = literal(value=1, id=499, pos=[(1,3754,56)])
  c_sign__3: bits[1] = tuple_index(c, index=0, id=503, pos=[(1,3754,80)])
  literal.504: bits[1] = literal(value=1, id=504, pos=[(1,3754,89)])
  slt.461: bits[1] = slt(bexp__1, literal.460, id=461, pos=[(1,3731,18)])
  bit_slice.463: bits[9] = bit_slice(bexp__1, start=0, width=9, id=463)
  literal.462: bits[9] = literal(value=0, id=462, pos=[(1,3731,48)])
  zero_ext.448: bits[74] = zero_ext(sub.447, new_bit_count=74, id=448)
  literal.350: bits[1] = literal(value=1, id=350)
  eq.353: bits[1] = eq(literal.352, tuple_index.351, id=353)
  literal.356: bits[1] = literal(value=1, id=356, pos=[(1,3676,16)])
  tuple_index.355: bits[1] = tuple_index(tuple.340, index=1, id=355)
  literal.341: bits[1] = literal(value=1, id=341)
  eq.344: bits[1] = eq(literal.343, tuple_index.342, id=344)
  invoke.484: bits[1] = invoke(ab, to_apply=__apfloat__is_product_inf__9_48, id=484, pos=[(1,3749,37)])
  eq.487: bits[1] = eq(ab_sign__2, literal.486, id=487, pos=[(1,3749,47)])
  invoke.489: bits[1] = invoke(c, to_apply=__apfloat__is_inf__8_23, id=489, pos=[(1,3749,72)])
  eq.492: bits[1] = eq(c_sign__2, literal.491, id=492, pos=[(1,3749,80)])
  invoke.497: bits[1] = invoke(ab, to_apply=__apfloat__is_product_inf__9_48, id=497, pos=[(1,3754,37)])
  eq.500: bits[1] = eq(ab_sign__3, literal.499, id=500, pos=[(1,3754,47)])
  invoke.502: bits[1] = invoke(c, to_apply=__apfloat__is_inf__8_23, id=502, pos=[(1,3754,72)])
  eq.505: bits[1] = eq(c_sign__3, literal.504, id=505, pos=[(1,3754,80)])
  invoke.469: bits[8] = invoke(to_apply=__std__mask_bits__8, id=469, pos=[(1,3739,38)])
  bexp__2: bits[9] = sel(slt.461, cases=[bit_slice.463, literal.462], id=464, pos=[(1,3731,15)])
  literal.465: bits[9] = literal(value=0, id=465, pos=[(1,3736,37)])
  shrl.449: bits[74] = shrl(rounded_fraction, zero_ext.448, id=449, pos=[(1,3724,27)])
  and.354: bits[1] = and(literal.350, eq.353, id=354)
  eq.357: bits[1] = eq(literal.356, tuple_index.355, id=357)
  and.345: bits[1] = and(literal.341, eq.344, id=345)
  literal.347: bits[1] = literal(value=1, id=347, pos=[(1,3675,15)])
  and.488: bits[1] = and(invoke.484, eq.487, id=488, pos=[(1,3749,37)])
  and.493: bits[1] = and(invoke.489, eq.492, id=493, pos=[(1,3749,72)])
  and.501: bits[1] = and(invoke.497, eq.500, id=501, pos=[(1,3754,37)])
  and.506: bits[1] = and(invoke.502, eq.505, id=506, pos=[(1,3754,72)])
  saturated_exp: bits[9] = zero_ext(invoke.469, new_bit_count=9, id=470)
  eq.466: bits[1] = eq(bexp__2, literal.465, id=466, pos=[(1,3736,29)])
  result_fraction: bits[23] = bit_slice(shrl.449, start=0, width=23, id=450)
  literal.467: bits[23] = literal(value=0, id=467, pos=[(1,3736,55)])
  and.358: bits[1] = and(and.354, eq.357, id=358)
  and.348: bits[1] = and(and.345, literal.347, id=348)
  invoke.508: bits[1] = invoke(ab, to_apply=__apfloat__is_product_nan__9_48, id=508, pos=[(1,3755,38)])
  invoke.509: bits[1] = invoke(c, to_apply=__apfloat__is_nan__8_23, id=509, pos=[(1,3755,51)])
  has_pos_inf: bits[1] = or(and.488, and.493, id=494, pos=[(1,3749,37)])
  has_neg_inf: bits[1] = or(and.501, and.506, id=507, pos=[(1,3754,37)])
  invoke.478: bits[1] = invoke(ab, to_apply=__apfloat__is_product_inf__9_48, id=478, pos=[(1,3745,39)])
  invoke.479: bits[1] = invoke(c, to_apply=__apfloat__is_inf__8_23, id=479, pos=[(1,3745,52)])
  ult.475: bits[1] = ult(bexp__2, saturated_exp, id=475, pos=[(1,3742,24)])
  max_exp: bits[8] = invoke(to_apply=__std__mask_bits__8, id=471, pos=[(1,3740,32)])
  bit_slice.476: bits[8] = bit_slice(bexp__2, start=0, width=8, id=476)
  ult.472: bits[1] = ult(bexp__2, saturated_exp, id=472, pos=[(1,3741,29)])
  literal.473: bits[23] = literal(value=0, id=473, pos=[(1,3741,77)])
  result_fraction__1: bits[23] = sel(eq.466, cases=[result_fraction, literal.467], id=468, pos=[(1,3736,26)])
  literal.515: bits[32] = literal(value=4, id=515, pos=[(1,3758,63)])
  nor.417: bits[1] = nor(and.394, and.403, and.412, id=417)
  concat.361: bits[2] = concat(and.358, and.348, id=361)
  literal.349: bits[1] = literal(value=0, id=349, pos=[(1,3675,21)])
  not.359: bits[1] = not(greater_sign, id=359, pos=[(1,3676,25)])
  or.510: bits[1] = or(invoke.508, invoke.509, id=510, pos=[(1,3755,38)])
  and.511: bits[1] = and(has_pos_inf, has_neg_inf, id=511, pos=[(1,3755,58)])
  is_operand_inf: bits[1] = or(invoke.478, invoke.479, id=480, pos=[(1,3745,39)])
  result_exp: bits[8] = sel(ult.475, cases=[max_exp, bit_slice.476], id=477, pos=[(1,3742,21)])
  result_fraction__2: bits[23] = sel(ult.472, cases=[literal.473, result_fraction__1], id=474, pos=[(1,3741,26)])
  literal.482: bits[23] = literal(value=0, id=482, pos=[(1,3747,46)])
  literal.514: bits[23] = literal(value=1, id=514, pos=[(1,3758,27)])
  sub.516: bits[32] = sub(FRACTION_SZ, literal.515, id=516, pos=[(1,3758,49)])
  and.418: bits[1] = and(__activated, nor.417, id=418)
  result_sign: bits[1] = priority_sel(concat.361, cases=[literal.349, not.359], default=greater_sign, id=362)
  not.495: bits[1] = not(has_pos_inf, id=495, pos=[(1,3750,42)])
  is_result_nan: bits[1] = or(or.510, and.511, id=512, pos=[(1,3755,38)])
  result_exp__1: bits[8] = sel(is_operand_inf, cases=[result_exp, max_exp], id=481, pos=[(1,3746,21)])
  result_fraction__3: bits[23] = sel(is_operand_inf, cases=[result_fraction__2, literal.482], id=483, pos=[(1,3747,26)])
  shll.517: bits[23] = shll(literal.514, sub.516, id=517, pos=[(1,3758,27)])
  not.419: bits[1] = not(and.418, id=419)
  result_sign__1: bits[1] = sel(is_operand_inf, cases=[result_sign, not.495], id=496, pos=[(1,3750,22)])
  literal.519: bits[1] = literal(value=0, id=519, pos=[(1,3759,41)])
  result_exp__2: bits[8] = sel(is_result_nan, cases=[result_exp__1, max_exp], id=513, pos=[(1,3756,21)])
  result_fraction__4: bits[23] = sel(is_result_nan, cases=[result_fraction__3, shll.517], id=518, pos=[(1,3758,8)])
  EXP_SZ: bits[32] = literal(value=8, id=255, pos=[(1,3614,11)])
  literal.257: bits[32] = literal(value=1, id=257, pos=[(1,3618,36)])
  literal.267: bits[32] = literal(value=1, id=267, pos=[(1,3624,53)])
  assert.420: token = assert(__token, not.419, message="Assertion failure via fail! @ /scratch/users/zrs29/xls/xls/xls/dslx/stdlib/apfloat.x:3704:19-3704:60", label="carry_and_cancel", id=420)
  result_sign__2: bits[1] = sel(is_result_nan, cases=[result_sign__1, literal.519], id=520, pos=[(1,3759,22)])
  zero_ext.521: bits[8] = zero_ext(result_exp__2, new_bit_count=8, id=521)
  zero_ext.522: bits[23] = zero_ext(result_fraction__4, new_bit_count=23, id=522)
  EXP_CARRY: bits[32] = add(EXP_SZ, literal.257, id=258, pos=[(1,3618,27)])
  literal.259: bits[32] = literal(value=1, id=259, pos=[(1,3620,44)])
  WIDE_FRACTION_CARRY: bits[32] = add(WIDE_FRACTION, literal.267, id=268, pos=[(1,3624,37)])
  literal.269: bits[32] = literal(value=1, id=269, pos=[(1,3626,64)])
  literal.272: bits[32] = literal(value=1, id=272, pos=[(1,3634,68)])
  after_all.524: token = after_all(assert.420, id=524)
  tuple.523: (bits[1], bits[8], bits[23]) = tuple(result_sign__2, zero_ext.521, zero_ext.522, id=523, pos=[(1,3761,33)])
  EXP_SIGN_CARRY: bits[32] = add(EXP_CARRY, literal.259, id=260, pos=[(1,3620,32)])
  WIDE_FRACTION_SIGN_CARRY: bits[32] = add(WIDE_FRACTION_CARRY, literal.269, id=270, pos=[(1,3626,42)])
  WIDE_FRACTION_TOP_ROUNDING: bits[32] = sub(WIDE_FRACTION_LOW_BIT, literal.272, id=273, pos=[(1,3634,44)])
  tuple_index.346: bits[1] = tuple_index(tuple.340, index=1, id=346)
  literal.360: bits[1] = literal(value=1, id=360, pos=[(1,3677,8)])
  literal.414: bits[1] = literal(value=1, id=414, pos=[(1,3703,8)])
  literal.415: bits[8][16] = literal(value=[99, 97, 114, 114, 121, 95, 97, 110, 100, 95, 99, 97, 110, 99, 101, 108], id=415, pos=[(1,3703,19)])
  ret tuple.525: (token, (bits[1], bits[8], bits[23])) = tuple(after_all.524, tuple.523, id=525)
}

fn __itok__float32__fma(__token: token id=526, __activated: bits[1] id=527, a: (bits[1], bits[8], bits[23]) id=528, b: (bits[1], bits[8], bits[23]) id=529, c: (bits[1], bits[8], bits[23]) id=530) -> (token, (bits[1], bits[8], bits[23])) {
  invoke.531: (token, (bits[1], bits[8], bits[23])) = invoke(__token, __activated, a, b, c, to_apply=__itok__apfloat__fma__8_23, id=531, pos=[(2,369,56)])
  tuple_index.532: token = tuple_index(invoke.531, index=0, id=532)
  after_all.534: token = after_all(tuple_index.532, id=534)
  tuple_index.533: (bits[1], bits[8], bits[23]) = tuple_index(invoke.531, index=1, id=533)
  ret tuple.535: (token, (bits[1], bits[8], bits[23])) = tuple(after_all.534, tuple_index.533, id=535)
}

fn __float32__fma(a: (bits[1], bits[8], bits[23]) id=536, b: (bits[1], bits[8], bits[23]) id=537, c: (bits[1], bits[8], bits[23]) id=538) -> (bits[1], bits[8], bits[23]) {
  after_all.539: token = after_all(id=539)
  literal.540: bits[1] = literal(value=1, id=540)
  invoke.541: (token, (bits[1], bits[8], bits[23])) = invoke(after_all.539, literal.540, a, b, c, to_apply=__itok__float32__fma, id=541)
  ret tuple_index.542: (bits[1], bits[8], bits[23]) = tuple_index(invoke.541, index=1, id=542)
}

fn __xls_systolic_4x4__node.init__1_0() -> (bits[1], (bits[1], bits[8], bits[23])) {
  literal.545: bits[1] = literal(value=0, id=545, pos=[(3,35,39)])
  invoke.546: (bits[1], bits[8], bits[23]) = invoke(to_apply=__float32__qnan, id=546, pos=[(3,35,67)])
  ROW: bits[32] = literal(value=0, id=543, pos=[(3,23,10)])
  COL: bits[32] = literal(value=1, id=544, pos=[(3,23,20)])
  ret tuple.547: (bits[1], (bits[1], bits[8], bits[23])) = tuple(literal.545, invoke.546, id=547, pos=[(3,35,22)])
}

fn __xls_systolic_4x4__node.init__2_0() -> (bits[1], (bits[1], bits[8], bits[23])) {
  literal.550: bits[1] = literal(value=0, id=550, pos=[(3,35,39)])
  invoke.551: (bits[1], bits[8], bits[23]) = invoke(to_apply=__float32__qnan, id=551, pos=[(3,35,67)])
  ROW: bits[32] = literal(value=0, id=548, pos=[(3,23,10)])
  COL: bits[32] = literal(value=2, id=549, pos=[(3,23,20)])
  ret tuple.552: (bits[1], (bits[1], bits[8], bits[23])) = tuple(literal.550, invoke.551, id=552, pos=[(3,35,22)])
}

fn __xls_systolic_4x4__node.init__3_0() -> (bits[1], (bits[1], bits[8], bits[23])) {
  literal.555: bits[1] = literal(value=0, id=555, pos=[(3,35,39)])
  invoke.556: (bits[1], bits[8], bits[23]) = invoke(to_apply=__float32__qnan, id=556, pos=[(3,35,67)])
  ROW: bits[32] = literal(value=0, id=553, pos=[(3,23,10)])
  COL: bits[32] = literal(value=3, id=554, pos=[(3,23,20)])
  ret tuple.557: (bits[1], (bits[1], bits[8], bits[23])) = tuple(literal.555, invoke.556, id=557, pos=[(3,35,22)])
}

fn __xls_systolic_4x4__node.init__0_1() -> (bits[1], (bits[1], bits[8], bits[23])) {
  literal.560: bits[1] = literal(value=0, id=560, pos=[(3,35,39)])
  invoke.561: (bits[1], bits[8], bits[23]) = invoke(to_apply=__float32__qnan, id=561, pos=[(3,35,67)])
  ROW: bits[32] = literal(value=1, id=558, pos=[(3,23,10)])
  COL: bits[32] = literal(value=0, id=559, pos=[(3,23,20)])
  ret tuple.562: (bits[1], (bits[1], bits[8], bits[23])) = tuple(literal.560, invoke.561, id=562, pos=[(3,35,22)])
}

fn __xls_systolic_4x4__node.init__1_1() -> (bits[1], (bits[1], bits[8], bits[23])) {
  literal.565: bits[1] = literal(value=0, id=565, pos=[(3,35,39)])
  invoke.566: (bits[1], bits[8], bits[23]) = invoke(to_apply=__float32__qnan, id=566, pos=[(3,35,67)])
  ROW: bits[32] = literal(value=1, id=563, pos=[(3,23,10)])
  COL: bits[32] = literal(value=1, id=564, pos=[(3,23,20)])
  ret tuple.567: (bits[1], (bits[1], bits[8], bits[23])) = tuple(literal.565, invoke.566, id=567, pos=[(3,35,22)])
}

fn __xls_systolic_4x4__node.init__2_1() -> (bits[1], (bits[1], bits[8], bits[23])) {
  literal.570: bits[1] = literal(value=0, id=570, pos=[(3,35,39)])
  invoke.571: (bits[1], bits[8], bits[23]) = invoke(to_apply=__float32__qnan, id=571, pos=[(3,35,67)])
  ROW: bits[32] = literal(value=1, id=568, pos=[(3,23,10)])
  COL: bits[32] = literal(value=2, id=569, pos=[(3,23,20)])
  ret tuple.572: (bits[1], (bits[1], bits[8], bits[23])) = tuple(literal.570, invoke.571, id=572, pos=[(3,35,22)])
}

fn __xls_systolic_4x4__node.init__3_1() -> (bits[1], (bits[1], bits[8], bits[23])) {
  literal.575: bits[1] = literal(value=0, id=575, pos=[(3,35,39)])
  invoke.576: (bits[1], bits[8], bits[23]) = invoke(to_apply=__float32__qnan, id=576, pos=[(3,35,67)])
  ROW: bits[32] = literal(value=1, id=573, pos=[(3,23,10)])
  COL: bits[32] = literal(value=3, id=574, pos=[(3,23,20)])
  ret tuple.577: (bits[1], (bits[1], bits[8], bits[23])) = tuple(literal.575, invoke.576, id=577, pos=[(3,35,22)])
}

fn __xls_systolic_4x4__node.init__0_2() -> (bits[1], (bits[1], bits[8], bits[23])) {
  literal.580: bits[1] = literal(value=0, id=580, pos=[(3,35,39)])
  invoke.581: (bits[1], bits[8], bits[23]) = invoke(to_apply=__float32__qnan, id=581, pos=[(3,35,67)])
  ROW: bits[32] = literal(value=2, id=578, pos=[(3,23,10)])
  COL: bits[32] = literal(value=0, id=579, pos=[(3,23,20)])
  ret tuple.582: (bits[1], (bits[1], bits[8], bits[23])) = tuple(literal.580, invoke.581, id=582, pos=[(3,35,22)])
}

fn __xls_systolic_4x4__node.init__1_2() -> (bits[1], (bits[1], bits[8], bits[23])) {
  literal.585: bits[1] = literal(value=0, id=585, pos=[(3,35,39)])
  invoke.586: (bits[1], bits[8], bits[23]) = invoke(to_apply=__float32__qnan, id=586, pos=[(3,35,67)])
  ROW: bits[32] = literal(value=2, id=583, pos=[(3,23,10)])
  COL: bits[32] = literal(value=1, id=584, pos=[(3,23,20)])
  ret tuple.587: (bits[1], (bits[1], bits[8], bits[23])) = tuple(literal.585, invoke.586, id=587, pos=[(3,35,22)])
}

fn __xls_systolic_4x4__node.init__2_2() -> (bits[1], (bits[1], bits[8], bits[23])) {
  literal.590: bits[1] = literal(value=0, id=590, pos=[(3,35,39)])
  invoke.591: (bits[1], bits[8], bits[23]) = invoke(to_apply=__float32__qnan, id=591, pos=[(3,35,67)])
  ROW: bits[32] = literal(value=2, id=588, pos=[(3,23,10)])
  COL: bits[32] = literal(value=2, id=589, pos=[(3,23,20)])
  ret tuple.592: (bits[1], (bits[1], bits[8], bits[23])) = tuple(literal.590, invoke.591, id=592, pos=[(3,35,22)])
}

fn __xls_systolic_4x4__node.init__3_2() -> (bits[1], (bits[1], bits[8], bits[23])) {
  literal.595: bits[1] = literal(value=0, id=595, pos=[(3,35,39)])
  invoke.596: (bits[1], bits[8], bits[23]) = invoke(to_apply=__float32__qnan, id=596, pos=[(3,35,67)])
  ROW: bits[32] = literal(value=2, id=593, pos=[(3,23,10)])
  COL: bits[32] = literal(value=3, id=594, pos=[(3,23,20)])
  ret tuple.597: (bits[1], (bits[1], bits[8], bits[23])) = tuple(literal.595, invoke.596, id=597, pos=[(3,35,22)])
}

fn __xls_systolic_4x4__node.init__0_3() -> (bits[1], (bits[1], bits[8], bits[23])) {
  literal.600: bits[1] = literal(value=0, id=600, pos=[(3,35,39)])
  invoke.601: (bits[1], bits[8], bits[23]) = invoke(to_apply=__float32__qnan, id=601, pos=[(3,35,67)])
  ROW: bits[32] = literal(value=3, id=598, pos=[(3,23,10)])
  COL: bits[32] = literal(value=0, id=599, pos=[(3,23,20)])
  ret tuple.602: (bits[1], (bits[1], bits[8], bits[23])) = tuple(literal.600, invoke.601, id=602, pos=[(3,35,22)])
}

fn __xls_systolic_4x4__node.init__1_3() -> (bits[1], (bits[1], bits[8], bits[23])) {
  literal.605: bits[1] = literal(value=0, id=605, pos=[(3,35,39)])
  invoke.606: (bits[1], bits[8], bits[23]) = invoke(to_apply=__float32__qnan, id=606, pos=[(3,35,67)])
  ROW: bits[32] = literal(value=3, id=603, pos=[(3,23,10)])
  COL: bits[32] = literal(value=1, id=604, pos=[(3,23,20)])
  ret tuple.607: (bits[1], (bits[1], bits[8], bits[23])) = tuple(literal.605, invoke.606, id=607, pos=[(3,35,22)])
}

fn __xls_systolic_4x4__node.init__2_3() -> (bits[1], (bits[1], bits[8], bits[23])) {
  literal.610: bits[1] = literal(value=0, id=610, pos=[(3,35,39)])
  invoke.611: (bits[1], bits[8], bits[23]) = invoke(to_apply=__float32__qnan, id=611, pos=[(3,35,67)])
  ROW: bits[32] = literal(value=3, id=608, pos=[(3,23,10)])
  COL: bits[32] = literal(value=2, id=609, pos=[(3,23,20)])
  ret tuple.612: (bits[1], (bits[1], bits[8], bits[23])) = tuple(literal.610, invoke.611, id=612, pos=[(3,35,22)])
}

fn __xls_systolic_4x4__node.init__3_3() -> (bits[1], (bits[1], bits[8], bits[23])) {
  literal.615: bits[1] = literal(value=0, id=615, pos=[(3,35,39)])
  invoke.616: (bits[1], bits[8], bits[23]) = invoke(to_apply=__float32__qnan, id=616, pos=[(3,35,67)])
  ROW: bits[32] = literal(value=3, id=613, pos=[(3,23,10)])
  COL: bits[32] = literal(value=3, id=614, pos=[(3,23,20)])
  ret tuple.617: (bits[1], (bits[1], bits[8], bits[23])) = tuple(literal.615, invoke.616, id=617, pos=[(3,35,22)])
}

fn __xls_systolic_4x4__matmul.init__4_4() -> bits[1] {
  ROWS: bits[32] = literal(value=4, id=618, pos=[(3,60,12)])
  COLS: bits[32] = literal(value=4, id=619, pos=[(3,60,23)])
  ret literal.620: bits[1] = literal(value=0, id=620, pos=[(3,90,11)])
}

proc __xls_systolic_4x4__matmul_4x4_0_next(__state: (), init={()}) {
  __state: () = state_read(state_element=__state, id=632)
  tuple.634: () = tuple(id=634, pos=[(3,146,19)])
  __token: token = literal(value=token, id=631)
  literal.633: bits[1] = literal(value=1, id=633)
  next_value.635: () = next_value(param=__state, value=tuple.634, id=635)
}

proc __xls_systolic_4x4__matmul_4x4__matmul_0__node_0__0_0_next(__state: (bits[1], (bits[1], bits[8], bits[23])), init={(0, (0, 255, 4194304))}) {
  __state: (bits[1], (bits[1], bits[8], bits[23])) = state_read(state_element=__state, id=637)
  __state_is_configured: bits[1] = tuple_index(__state, index=0, id=642, pos=[(3,40,48)])
  literal.638: bits[1] = literal(value=1, id=638)
  not.643: bits[1] = not(__state_is_configured, id=643, pos=[(3,40,42)])
  literal.641: token = literal(value=token, id=641)
  and.645: bits[1] = and(literal.638, not.643, id=645)
  receive.646: (token, (bits[1], bits[8], bits[23])) = receive(literal.641, predicate=and.645, channel=xls_systolic_4x4__node_weights__0_0, id=646)
  __state_weight: (bits[1], bits[8], bits[23]) = tuple_index(__state, index=1, id=644, pos=[(3,40,69)])
  tuple_index.648: (bits[1], bits[8], bits[23]) = tuple_index(receive.646, index=1, id=648)
  tuple_index.647: token = tuple_index(receive.646, index=0, id=647)
  sel.649: (bits[1], bits[8], bits[23]) = sel(not.643, cases=[__state_weight, tuple_index.648], id=649)
  tuple.650: (token, (bits[1], bits[8], bits[23])) = tuple(tuple_index.647, sel.649, id=650)
  weight_tok: token = tuple_index(tuple.650, index=0, id=651, pos=[(3,39,13)])
  receive.653: (token, (bits[1], bits[8], bits[23])) = receive(weight_tok, predicate=literal.638, channel=xls_systolic_4x4__east_west__0_0, id=653)
  receive.657: (token, (bits[1], bits[8], bits[23])) = receive(weight_tok, predicate=literal.638, channel=xls_systolic_4x4__north_south__0_0, id=657)
  __token: token = literal(value=token, id=636)
  activation: (bits[1], bits[8], bits[23]) = tuple_index(receive.653, index=1, id=656, pos=[(3,42,29)])
  weight: (bits[1], bits[8], bits[23]) = tuple_index(tuple.650, index=1, id=652, pos=[(3,39,25)])
  partial_sum: (bits[1], bits[8], bits[23]) = tuple_index(receive.657, index=1, id=660, pos=[(3,44,30)])
  invoke.662: (token, (bits[1], bits[8], bits[23])) = invoke(__token, literal.638, activation, weight, partial_sum, to_apply=__itok__float32__fma, id=662, pos=[(3,48,33)])
  result: (bits[1], bits[8], bits[23]) = tuple_index(invoke.662, index=1, id=664)
  activation_tok: token = tuple_index(receive.653, index=0, id=655, pos=[(3,42,13)])
  partial_sum_tok: token = tuple_index(receive.657, index=0, id=659, pos=[(3,44,13)])
  literal.680: bits[1] = literal(value=1, id=680, pos=[(3,55,36)])
  ROW: bits[32] = literal(value=0, id=639, pos=[(3,23,10)])
  COL: bits[32] = literal(value=0, id=640, pos=[(3,23,20)])
  tuple_index.665: bits[1] = tuple_index(activation, index=0, id=665)
  tuple_index.666: bits[8] = tuple_index(activation, index=1, id=666)
  tuple_index.667: bits[23] = tuple_index(activation, index=2, id=667)
  tuple_index.668: bits[1] = tuple_index(weight, index=0, id=668)
  tuple_index.669: bits[8] = tuple_index(weight, index=1, id=669)
  tuple_index.670: bits[23] = tuple_index(weight, index=2, id=670)
  tuple_index.671: bits[1] = tuple_index(partial_sum, index=0, id=671)
  tuple_index.672: bits[8] = tuple_index(partial_sum, index=1, id=672)
  tuple_index.673: bits[23] = tuple_index(partial_sum, index=2, id=673)
  tuple_index.674: bits[1] = tuple_index(result, index=0, id=674)
  tuple_index.675: bits[8] = tuple_index(result, index=1, id=675)
  tuple_index.676: bits[23] = tuple_index(result, index=2, id=676)
  input_tok: token = after_all(activation_tok, partial_sum_tok, id=661)
  tuple.681: (bits[1], (bits[1], bits[8], bits[23])) = tuple(literal.680, weight, id=681, pos=[(3,55,19)])
  tuple_index.654: token = tuple_index(receive.653, index=0, id=654)
  tuple_index.658: token = tuple_index(receive.657, index=0, id=658)
  tuple_index.663: token = tuple_index(invoke.662, index=0, id=663)
  trace.677: token = trace(__token, literal.638, format="node[{}, {}]: fma(activation=APFloat{{sign: {}, bexp: {}, fraction: {}}}, weight=APFloat{{sign: {}, bexp: {}, fraction: {}}}, partial_sum=APFloat{{sign: {}, bexp: {}, fraction: {}}}) = APFloat{{sign: {}, bexp: {}, fraction: {}}}", data_operands=[ROW, COL, tuple_index.665, tuple_index.666, tuple_index.667, tuple_index.668, tuple_index.669, tuple_index.670, tuple_index.671, tuple_index.672, tuple_index.673, tuple_index.674, tuple_index.675, tuple_index.676], id=677)
  send.678: token = send(input_tok, activation, predicate=literal.638, channel=xls_systolic_4x4__east_west__0_1, id=678)
  send.679: token = send(input_tok, result, predicate=literal.638, channel=xls_systolic_4x4__north_south__1_0, id=679)
  next_value.682: () = next_value(param=__state, value=tuple.681, id=682)
}

proc __xls_systolic_4x4__matmul_4x4__matmul_0__node_1__1_0_next(__state: (bits[1], (bits[1], bits[8], bits[23])), init={(0, (0, 255, 4194304))}) {
  __state: (bits[1], (bits[1], bits[8], bits[23])) = state_read(state_element=__state, id=684)
  __state_is_configured: bits[1] = tuple_index(__state, index=0, id=689, pos=[(3,40,48)])
  literal.685: bits[1] = literal(value=1, id=685)
  not.690: bits[1] = not(__state_is_configured, id=690, pos=[(3,40,42)])
  literal.688: token = literal(value=token, id=688)
  and.692: bits[1] = and(literal.685, not.690, id=692)
  receive.693: (token, (bits[1], bits[8], bits[23])) = receive(literal.688, predicate=and.692, channel=xls_systolic_4x4__node_weights__0_1, id=693)
  __state_weight: (bits[1], bits[8], bits[23]) = tuple_index(__state, index=1, id=691, pos=[(3,40,69)])
  tuple_index.695: (bits[1], bits[8], bits[23]) = tuple_index(receive.693, index=1, id=695)
  tuple_index.694: token = tuple_index(receive.693, index=0, id=694)
  sel.696: (bits[1], bits[8], bits[23]) = sel(not.690, cases=[__state_weight, tuple_index.695], id=696)
  tuple.697: (token, (bits[1], bits[8], bits[23])) = tuple(tuple_index.694, sel.696, id=697)
  weight_tok: token = tuple_index(tuple.697, index=0, id=698, pos=[(3,39,13)])
  receive.700: (token, (bits[1], bits[8], bits[23])) = receive(weight_tok, predicate=literal.685, channel=xls_systolic_4x4__east_west__0_1, id=700)
  receive.704: (token, (bits[1], bits[8], bits[23])) = receive(weight_tok, predicate=literal.685, channel=xls_systolic_4x4__north_south__0_1, id=704)
  __token: token = literal(value=token, id=683)
  activation: (bits[1], bits[8], bits[23]) = tuple_index(receive.700, index=1, id=703, pos=[(3,42,29)])
  weight: (bits[1], bits[8], bits[23]) = tuple_index(tuple.697, index=1, id=699, pos=[(3,39,25)])
  partial_sum: (bits[1], bits[8], bits[23]) = tuple_index(receive.704, index=1, id=707, pos=[(3,44,30)])
  invoke.709: (token, (bits[1], bits[8], bits[23])) = invoke(__token, literal.685, activation, weight, partial_sum, to_apply=__itok__float32__fma, id=709, pos=[(3,48,33)])
  result: (bits[1], bits[8], bits[23]) = tuple_index(invoke.709, index=1, id=711)
  activation_tok: token = tuple_index(receive.700, index=0, id=702, pos=[(3,42,13)])
  partial_sum_tok: token = tuple_index(receive.704, index=0, id=706, pos=[(3,44,13)])
  literal.727: bits[1] = literal(value=1, id=727, pos=[(3,55,36)])
  ROW: bits[32] = literal(value=0, id=686, pos=[(3,23,10)])
  COL: bits[32] = literal(value=1, id=687, pos=[(3,23,20)])
  tuple_index.712: bits[1] = tuple_index(activation, index=0, id=712)
  tuple_index.713: bits[8] = tuple_index(activation, index=1, id=713)
  tuple_index.714: bits[23] = tuple_index(activation, index=2, id=714)
  tuple_index.715: bits[1] = tuple_index(weight, index=0, id=715)
  tuple_index.716: bits[8] = tuple_index(weight, index=1, id=716)
  tuple_index.717: bits[23] = tuple_index(weight, index=2, id=717)
  tuple_index.718: bits[1] = tuple_index(partial_sum, index=0, id=718)
  tuple_index.719: bits[8] = tuple_index(partial_sum, index=1, id=719)
  tuple_index.720: bits[23] = tuple_index(partial_sum, index=2, id=720)
  tuple_index.721: bits[1] = tuple_index(result, index=0, id=721)
  tuple_index.722: bits[8] = tuple_index(result, index=1, id=722)
  tuple_index.723: bits[23] = tuple_index(result, index=2, id=723)
  input_tok: token = after_all(activation_tok, partial_sum_tok, id=708)
  tuple.728: (bits[1], (bits[1], bits[8], bits[23])) = tuple(literal.727, weight, id=728, pos=[(3,55,19)])
  tuple_index.701: token = tuple_index(receive.700, index=0, id=701)
  tuple_index.705: token = tuple_index(receive.704, index=0, id=705)
  tuple_index.710: token = tuple_index(invoke.709, index=0, id=710)
  trace.724: token = trace(__token, literal.685, format="node[{}, {}]: fma(activation=APFloat{{sign: {}, bexp: {}, fraction: {}}}, weight=APFloat{{sign: {}, bexp: {}, fraction: {}}}, partial_sum=APFloat{{sign: {}, bexp: {}, fraction: {}}}) = APFloat{{sign: {}, bexp: {}, fraction: {}}}", data_operands=[ROW, COL, tuple_index.712, tuple_index.713, tuple_index.714, tuple_index.715, tuple_index.716, tuple_index.717, tuple_index.718, tuple_index.719, tuple_index.720, tuple_index.721, tuple_index.722, tuple_index.723], id=724)
  send.725: token = send(input_tok, activation, predicate=literal.685, channel=xls_systolic_4x4__east_west__0_2, id=725)
  send.726: token = send(input_tok, result, predicate=literal.685, channel=xls_systolic_4x4__north_south__1_1, id=726)
  next_value.729: () = next_value(param=__state, value=tuple.728, id=729)
}

proc __xls_systolic_4x4__matmul_4x4__matmul_0__node_2__2_0_next(__state: (bits[1], (bits[1], bits[8], bits[23])), init={(0, (0, 255, 4194304))}) {
  __state: (bits[1], (bits[1], bits[8], bits[23])) = state_read(state_element=__state, id=731)
  __state_is_configured: bits[1] = tuple_index(__state, index=0, id=736, pos=[(3,40,48)])
  literal.732: bits[1] = literal(value=1, id=732)
  not.737: bits[1] = not(__state_is_configured, id=737, pos=[(3,40,42)])
  literal.735: token = literal(value=token, id=735)
  and.739: bits[1] = and(literal.732, not.737, id=739)
  receive.740: (token, (bits[1], bits[8], bits[23])) = receive(literal.735, predicate=and.739, channel=xls_systolic_4x4__node_weights__0_2, id=740)
  __state_weight: (bits[1], bits[8], bits[23]) = tuple_index(__state, index=1, id=738, pos=[(3,40,69)])
  tuple_index.742: (bits[1], bits[8], bits[23]) = tuple_index(receive.740, index=1, id=742)
  tuple_index.741: token = tuple_index(receive.740, index=0, id=741)
  sel.743: (bits[1], bits[8], bits[23]) = sel(not.737, cases=[__state_weight, tuple_index.742], id=743)
  tuple.744: (token, (bits[1], bits[8], bits[23])) = tuple(tuple_index.741, sel.743, id=744)
  weight_tok: token = tuple_index(tuple.744, index=0, id=745, pos=[(3,39,13)])
  receive.747: (token, (bits[1], bits[8], bits[23])) = receive(weight_tok, predicate=literal.732, channel=xls_systolic_4x4__east_west__0_2, id=747)
  receive.751: (token, (bits[1], bits[8], bits[23])) = receive(weight_tok, predicate=literal.732, channel=xls_systolic_4x4__north_south__0_2, id=751)
  __token: token = literal(value=token, id=730)
  activation: (bits[1], bits[8], bits[23]) = tuple_index(receive.747, index=1, id=750, pos=[(3,42,29)])
  weight: (bits[1], bits[8], bits[23]) = tuple_index(tuple.744, index=1, id=746, pos=[(3,39,25)])
  partial_sum: (bits[1], bits[8], bits[23]) = tuple_index(receive.751, index=1, id=754, pos=[(3,44,30)])
  invoke.756: (token, (bits[1], bits[8], bits[23])) = invoke(__token, literal.732, activation, weight, partial_sum, to_apply=__itok__float32__fma, id=756, pos=[(3,48,33)])
  result: (bits[1], bits[8], bits[23]) = tuple_index(invoke.756, index=1, id=758)
  activation_tok: token = tuple_index(receive.747, index=0, id=749, pos=[(3,42,13)])
  partial_sum_tok: token = tuple_index(receive.751, index=0, id=753, pos=[(3,44,13)])
  literal.774: bits[1] = literal(value=1, id=774, pos=[(3,55,36)])
  ROW: bits[32] = literal(value=0, id=733, pos=[(3,23,10)])
  COL: bits[32] = literal(value=2, id=734, pos=[(3,23,20)])
  tuple_index.759: bits[1] = tuple_index(activation, index=0, id=759)
  tuple_index.760: bits[8] = tuple_index(activation, index=1, id=760)
  tuple_index.761: bits[23] = tuple_index(activation, index=2, id=761)
  tuple_index.762: bits[1] = tuple_index(weight, index=0, id=762)
  tuple_index.763: bits[8] = tuple_index(weight, index=1, id=763)
  tuple_index.764: bits[23] = tuple_index(weight, index=2, id=764)
  tuple_index.765: bits[1] = tuple_index(partial_sum, index=0, id=765)
  tuple_index.766: bits[8] = tuple_index(partial_sum, index=1, id=766)
  tuple_index.767: bits[23] = tuple_index(partial_sum, index=2, id=767)
  tuple_index.768: bits[1] = tuple_index(result, index=0, id=768)
  tuple_index.769: bits[8] = tuple_index(result, index=1, id=769)
  tuple_index.770: bits[23] = tuple_index(result, index=2, id=770)
  input_tok: token = after_all(activation_tok, partial_sum_tok, id=755)
  tuple.775: (bits[1], (bits[1], bits[8], bits[23])) = tuple(literal.774, weight, id=775, pos=[(3,55,19)])
  tuple_index.748: token = tuple_index(receive.747, index=0, id=748)
  tuple_index.752: token = tuple_index(receive.751, index=0, id=752)
  tuple_index.757: token = tuple_index(invoke.756, index=0, id=757)
  trace.771: token = trace(__token, literal.732, format="node[{}, {}]: fma(activation=APFloat{{sign: {}, bexp: {}, fraction: {}}}, weight=APFloat{{sign: {}, bexp: {}, fraction: {}}}, partial_sum=APFloat{{sign: {}, bexp: {}, fraction: {}}}) = APFloat{{sign: {}, bexp: {}, fraction: {}}}", data_operands=[ROW, COL, tuple_index.759, tuple_index.760, tuple_index.761, tuple_index.762, tuple_index.763, tuple_index.764, tuple_index.765, tuple_index.766, tuple_index.767, tuple_index.768, tuple_index.769, tuple_index.770], id=771)
  send.772: token = send(input_tok, activation, predicate=literal.732, channel=xls_systolic_4x4__east_west__0_3, id=772)
  send.773: token = send(input_tok, result, predicate=literal.732, channel=xls_systolic_4x4__north_south__1_2, id=773)
  next_value.776: () = next_value(param=__state, value=tuple.775, id=776)
}

proc __xls_systolic_4x4__matmul_4x4__matmul_0__node_3__3_0_next(__state: (bits[1], (bits[1], bits[8], bits[23])), init={(0, (0, 255, 4194304))}) {
  __state: (bits[1], (bits[1], bits[8], bits[23])) = state_read(state_element=__state, id=778)
  __state_is_configured: bits[1] = tuple_index(__state, index=0, id=783, pos=[(3,40,48)])
  literal.779: bits[1] = literal(value=1, id=779)
  not.784: bits[1] = not(__state_is_configured, id=784, pos=[(3,40,42)])
  literal.782: token = literal(value=token, id=782)
  and.786: bits[1] = and(literal.779, not.784, id=786)
  receive.787: (token, (bits[1], bits[8], bits[23])) = receive(literal.782, predicate=and.786, channel=xls_systolic_4x4__node_weights__0_3, id=787)
  __state_weight: (bits[1], bits[8], bits[23]) = tuple_index(__state, index=1, id=785, pos=[(3,40,69)])
  tuple_index.789: (bits[1], bits[8], bits[23]) = tuple_index(receive.787, index=1, id=789)
  tuple_index.788: token = tuple_index(receive.787, index=0, id=788)
  sel.790: (bits[1], bits[8], bits[23]) = sel(not.784, cases=[__state_weight, tuple_index.789], id=790)
  tuple.791: (token, (bits[1], bits[8], bits[23])) = tuple(tuple_index.788, sel.790, id=791)
  weight_tok: token = tuple_index(tuple.791, index=0, id=792, pos=[(3,39,13)])
  receive.794: (token, (bits[1], bits[8], bits[23])) = receive(weight_tok, predicate=literal.779, channel=xls_systolic_4x4__east_west__0_3, id=794)
  receive.798: (token, (bits[1], bits[8], bits[23])) = receive(weight_tok, predicate=literal.779, channel=xls_systolic_4x4__north_south__0_3, id=798)
  __token: token = literal(value=token, id=777)
  activation: (bits[1], bits[8], bits[23]) = tuple_index(receive.794, index=1, id=797, pos=[(3,42,29)])
  weight: (bits[1], bits[8], bits[23]) = tuple_index(tuple.791, index=1, id=793, pos=[(3,39,25)])
  partial_sum: (bits[1], bits[8], bits[23]) = tuple_index(receive.798, index=1, id=801, pos=[(3,44,30)])
  invoke.803: (token, (bits[1], bits[8], bits[23])) = invoke(__token, literal.779, activation, weight, partial_sum, to_apply=__itok__float32__fma, id=803, pos=[(3,48,33)])
  result: (bits[1], bits[8], bits[23]) = tuple_index(invoke.803, index=1, id=805)
  activation_tok: token = tuple_index(receive.794, index=0, id=796, pos=[(3,42,13)])
  partial_sum_tok: token = tuple_index(receive.798, index=0, id=800, pos=[(3,44,13)])
  literal.821: bits[1] = literal(value=1, id=821, pos=[(3,55,36)])
  ROW: bits[32] = literal(value=0, id=780, pos=[(3,23,10)])
  COL: bits[32] = literal(value=3, id=781, pos=[(3,23,20)])
  tuple_index.806: bits[1] = tuple_index(activation, index=0, id=806)
  tuple_index.807: bits[8] = tuple_index(activation, index=1, id=807)
  tuple_index.808: bits[23] = tuple_index(activation, index=2, id=808)
  tuple_index.809: bits[1] = tuple_index(weight, index=0, id=809)
  tuple_index.810: bits[8] = tuple_index(weight, index=1, id=810)
  tuple_index.811: bits[23] = tuple_index(weight, index=2, id=811)
  tuple_index.812: bits[1] = tuple_index(partial_sum, index=0, id=812)
  tuple_index.813: bits[8] = tuple_index(partial_sum, index=1, id=813)
  tuple_index.814: bits[23] = tuple_index(partial_sum, index=2, id=814)
  tuple_index.815: bits[1] = tuple_index(result, index=0, id=815)
  tuple_index.816: bits[8] = tuple_index(result, index=1, id=816)
  tuple_index.817: bits[23] = tuple_index(result, index=2, id=817)
  input_tok: token = after_all(activation_tok, partial_sum_tok, id=802)
  tuple.822: (bits[1], (bits[1], bits[8], bits[23])) = tuple(literal.821, weight, id=822, pos=[(3,55,19)])
  tuple_index.795: token = tuple_index(receive.794, index=0, id=795)
  tuple_index.799: token = tuple_index(receive.798, index=0, id=799)
  tuple_index.804: token = tuple_index(invoke.803, index=0, id=804)
  trace.818: token = trace(__token, literal.779, format="node[{}, {}]: fma(activation=APFloat{{sign: {}, bexp: {}, fraction: {}}}, weight=APFloat{{sign: {}, bexp: {}, fraction: {}}}, partial_sum=APFloat{{sign: {}, bexp: {}, fraction: {}}}) = APFloat{{sign: {}, bexp: {}, fraction: {}}}", data_operands=[ROW, COL, tuple_index.806, tuple_index.807, tuple_index.808, tuple_index.809, tuple_index.810, tuple_index.811, tuple_index.812, tuple_index.813, tuple_index.814, tuple_index.815, tuple_index.816, tuple_index.817], id=818)
  send.819: token = send(input_tok, activation, predicate=literal.779, channel=xls_systolic_4x4__east_west__0_4, id=819)
  send.820: token = send(input_tok, result, predicate=literal.779, channel=xls_systolic_4x4__north_south__1_3, id=820)
  next_value.823: () = next_value(param=__state, value=tuple.822, id=823)
}

proc __xls_systolic_4x4__matmul_4x4__matmul_0__node_4__0_1_next(__state: (bits[1], (bits[1], bits[8], bits[23])), init={(0, (0, 255, 4194304))}) {
  __state: (bits[1], (bits[1], bits[8], bits[23])) = state_read(state_element=__state, id=825)
  __state_is_configured: bits[1] = tuple_index(__state, index=0, id=830, pos=[(3,40,48)])
  literal.826: bits[1] = literal(value=1, id=826)
  not.831: bits[1] = not(__state_is_configured, id=831, pos=[(3,40,42)])
  literal.829: token = literal(value=token, id=829)
  and.833: bits[1] = and(literal.826, not.831, id=833)
  receive.834: (token, (bits[1], bits[8], bits[23])) = receive(literal.829, predicate=and.833, channel=xls_systolic_4x4__node_weights__1_0, id=834)
  __state_weight: (bits[1], bits[8], bits[23]) = tuple_index(__state, index=1, id=832, pos=[(3,40,69)])
  tuple_index.836: (bits[1], bits[8], bits[23]) = tuple_index(receive.834, index=1, id=836)
  tuple_index.835: token = tuple_index(receive.834, index=0, id=835)
  sel.837: (bits[1], bits[8], bits[23]) = sel(not.831, cases=[__state_weight, tuple_index.836], id=837)
  tuple.838: (token, (bits[1], bits[8], bits[23])) = tuple(tuple_index.835, sel.837, id=838)
  weight_tok: token = tuple_index(tuple.838, index=0, id=839, pos=[(3,39,13)])
  receive.841: (token, (bits[1], bits[8], bits[23])) = receive(weight_tok, predicate=literal.826, channel=xls_systolic_4x4__east_west__1_0, id=841)
  receive.845: (token, (bits[1], bits[8], bits[23])) = receive(weight_tok, predicate=literal.826, channel=xls_systolic_4x4__north_south__1_0, id=845)
  __token: token = literal(value=token, id=824)
  activation: (bits[1], bits[8], bits[23]) = tuple_index(receive.841, index=1, id=844, pos=[(3,42,29)])
  weight: (bits[1], bits[8], bits[23]) = tuple_index(tuple.838, index=1, id=840, pos=[(3,39,25)])
  partial_sum: (bits[1], bits[8], bits[23]) = tuple_index(receive.845, index=1, id=848, pos=[(3,44,30)])
  invoke.850: (token, (bits[1], bits[8], bits[23])) = invoke(__token, literal.826, activation, weight, partial_sum, to_apply=__itok__float32__fma, id=850, pos=[(3,48,33)])
  result: (bits[1], bits[8], bits[23]) = tuple_index(invoke.850, index=1, id=852)
  activation_tok: token = tuple_index(receive.841, index=0, id=843, pos=[(3,42,13)])
  partial_sum_tok: token = tuple_index(receive.845, index=0, id=847, pos=[(3,44,13)])
  literal.868: bits[1] = literal(value=1, id=868, pos=[(3,55,36)])
  ROW: bits[32] = literal(value=1, id=827, pos=[(3,23,10)])
  COL: bits[32] = literal(value=0, id=828, pos=[(3,23,20)])
  tuple_index.853: bits[1] = tuple_index(activation, index=0, id=853)
  tuple_index.854: bits[8] = tuple_index(activation, index=1, id=854)
  tuple_index.855: bits[23] = tuple_index(activation, index=2, id=855)
  tuple_index.856: bits[1] = tuple_index(weight, index=0, id=856)
  tuple_index.857: bits[8] = tuple_index(weight, index=1, id=857)
  tuple_index.858: bits[23] = tuple_index(weight, index=2, id=858)
  tuple_index.859: bits[1] = tuple_index(partial_sum, index=0, id=859)
  tuple_index.860: bits[8] = tuple_index(partial_sum, index=1, id=860)
  tuple_index.861: bits[23] = tuple_index(partial_sum, index=2, id=861)
  tuple_index.862: bits[1] = tuple_index(result, index=0, id=862)
  tuple_index.863: bits[8] = tuple_index(result, index=1, id=863)
  tuple_index.864: bits[23] = tuple_index(result, index=2, id=864)
  input_tok: token = after_all(activation_tok, partial_sum_tok, id=849)
  tuple.869: (bits[1], (bits[1], bits[8], bits[23])) = tuple(literal.868, weight, id=869, pos=[(3,55,19)])
  tuple_index.842: token = tuple_index(receive.841, index=0, id=842)
  tuple_index.846: token = tuple_index(receive.845, index=0, id=846)
  tuple_index.851: token = tuple_index(invoke.850, index=0, id=851)
  trace.865: token = trace(__token, literal.826, format="node[{}, {}]: fma(activation=APFloat{{sign: {}, bexp: {}, fraction: {}}}, weight=APFloat{{sign: {}, bexp: {}, fraction: {}}}, partial_sum=APFloat{{sign: {}, bexp: {}, fraction: {}}}) = APFloat{{sign: {}, bexp: {}, fraction: {}}}", data_operands=[ROW, COL, tuple_index.853, tuple_index.854, tuple_index.855, tuple_index.856, tuple_index.857, tuple_index.858, tuple_index.859, tuple_index.860, tuple_index.861, tuple_index.862, tuple_index.863, tuple_index.864], id=865)
  send.866: token = send(input_tok, activation, predicate=literal.826, channel=xls_systolic_4x4__east_west__1_1, id=866)
  send.867: token = send(input_tok, result, predicate=literal.826, channel=xls_systolic_4x4__north_south__2_0, id=867)
  next_value.870: () = next_value(param=__state, value=tuple.869, id=870)
}

proc __xls_systolic_4x4__matmul_4x4__matmul_0__node_5__1_1_next(__state: (bits[1], (bits[1], bits[8], bits[23])), init={(0, (0, 255, 4194304))}) {
  __state: (bits[1], (bits[1], bits[8], bits[23])) = state_read(state_element=__state, id=872)
  __state_is_configured: bits[1] = tuple_index(__state, index=0, id=877, pos=[(3,40,48)])
  literal.873: bits[1] = literal(value=1, id=873)
  not.878: bits[1] = not(__state_is_configured, id=878, pos=[(3,40,42)])
  literal.876: token = literal(value=token, id=876)
  and.880: bits[1] = and(literal.873, not.878, id=880)
  receive.881: (token, (bits[1], bits[8], bits[23])) = receive(literal.876, predicate=and.880, channel=xls_systolic_4x4__node_weights__1_1, id=881)
  __state_weight: (bits[1], bits[8], bits[23]) = tuple_index(__state, index=1, id=879, pos=[(3,40,69)])
  tuple_index.883: (bits[1], bits[8], bits[23]) = tuple_index(receive.881, index=1, id=883)
  tuple_index.882: token = tuple_index(receive.881, index=0, id=882)
  sel.884: (bits[1], bits[8], bits[23]) = sel(not.878, cases=[__state_weight, tuple_index.883], id=884)
  tuple.885: (token, (bits[1], bits[8], bits[23])) = tuple(tuple_index.882, sel.884, id=885)
  weight_tok: token = tuple_index(tuple.885, index=0, id=886, pos=[(3,39,13)])
  receive.888: (token, (bits[1], bits[8], bits[23])) = receive(weight_tok, predicate=literal.873, channel=xls_systolic_4x4__east_west__1_1, id=888)
  receive.892: (token, (bits[1], bits[8], bits[23])) = receive(weight_tok, predicate=literal.873, channel=xls_systolic_4x4__north_south__1_1, id=892)
  __token: token = literal(value=token, id=871)
  activation: (bits[1], bits[8], bits[23]) = tuple_index(receive.888, index=1, id=891, pos=[(3,42,29)])
  weight: (bits[1], bits[8], bits[23]) = tuple_index(tuple.885, index=1, id=887, pos=[(3,39,25)])
  partial_sum: (bits[1], bits[8], bits[23]) = tuple_index(receive.892, index=1, id=895, pos=[(3,44,30)])
  invoke.897: (token, (bits[1], bits[8], bits[23])) = invoke(__token, literal.873, activation, weight, partial_sum, to_apply=__itok__float32__fma, id=897, pos=[(3,48,33)])
  result: (bits[1], bits[8], bits[23]) = tuple_index(invoke.897, index=1, id=899)
  activation_tok: token = tuple_index(receive.888, index=0, id=890, pos=[(3,42,13)])
  partial_sum_tok: token = tuple_index(receive.892, index=0, id=894, pos=[(3,44,13)])
  literal.915: bits[1] = literal(value=1, id=915, pos=[(3,55,36)])
  ROW: bits[32] = literal(value=1, id=874, pos=[(3,23,10)])
  COL: bits[32] = literal(value=1, id=875, pos=[(3,23,20)])
  tuple_index.900: bits[1] = tuple_index(activation, index=0, id=900)
  tuple_index.901: bits[8] = tuple_index(activation, index=1, id=901)
  tuple_index.902: bits[23] = tuple_index(activation, index=2, id=902)
  tuple_index.903: bits[1] = tuple_index(weight, index=0, id=903)
  tuple_index.904: bits[8] = tuple_index(weight, index=1, id=904)
  tuple_index.905: bits[23] = tuple_index(weight, index=2, id=905)
  tuple_index.906: bits[1] = tuple_index(partial_sum, index=0, id=906)
  tuple_index.907: bits[8] = tuple_index(partial_sum, index=1, id=907)
  tuple_index.908: bits[23] = tuple_index(partial_sum, index=2, id=908)
  tuple_index.909: bits[1] = tuple_index(result, index=0, id=909)
  tuple_index.910: bits[8] = tuple_index(result, index=1, id=910)
  tuple_index.911: bits[23] = tuple_index(result, index=2, id=911)
  input_tok: token = after_all(activation_tok, partial_sum_tok, id=896)
  tuple.916: (bits[1], (bits[1], bits[8], bits[23])) = tuple(literal.915, weight, id=916, pos=[(3,55,19)])
  tuple_index.889: token = tuple_index(receive.888, index=0, id=889)
  tuple_index.893: token = tuple_index(receive.892, index=0, id=893)
  tuple_index.898: token = tuple_index(invoke.897, index=0, id=898)
  trace.912: token = trace(__token, literal.873, format="node[{}, {}]: fma(activation=APFloat{{sign: {}, bexp: {}, fraction: {}}}, weight=APFloat{{sign: {}, bexp: {}, fraction: {}}}, partial_sum=APFloat{{sign: {}, bexp: {}, fraction: {}}}) = APFloat{{sign: {}, bexp: {}, fraction: {}}}", data_operands=[ROW, COL, tuple_index.900, tuple_index.901, tuple_index.902, tuple_index.903, tuple_index.904, tuple_index.905, tuple_index.906, tuple_index.907, tuple_index.908, tuple_index.909, tuple_index.910, tuple_index.911], id=912)
  send.913: token = send(input_tok, activation, predicate=literal.873, channel=xls_systolic_4x4__east_west__1_2, id=913)
  send.914: token = send(input_tok, result, predicate=literal.873, channel=xls_systolic_4x4__north_south__2_1, id=914)
  next_value.917: () = next_value(param=__state, value=tuple.916, id=917)
}

proc __xls_systolic_4x4__matmul_4x4__matmul_0__node_6__2_1_next(__state: (bits[1], (bits[1], bits[8], bits[23])), init={(0, (0, 255, 4194304))}) {
  __state: (bits[1], (bits[1], bits[8], bits[23])) = state_read(state_element=__state, id=919)
  __state_is_configured: bits[1] = tuple_index(__state, index=0, id=924, pos=[(3,40,48)])
  literal.920: bits[1] = literal(value=1, id=920)
  not.925: bits[1] = not(__state_is_configured, id=925, pos=[(3,40,42)])
  literal.923: token = literal(value=token, id=923)
  and.927: bits[1] = and(literal.920, not.925, id=927)
  receive.928: (token, (bits[1], bits[8], bits[23])) = receive(literal.923, predicate=and.927, channel=xls_systolic_4x4__node_weights__1_2, id=928)
  __state_weight: (bits[1], bits[8], bits[23]) = tuple_index(__state, index=1, id=926, pos=[(3,40,69)])
  tuple_index.930: (bits[1], bits[8], bits[23]) = tuple_index(receive.928, index=1, id=930)
  tuple_index.929: token = tuple_index(receive.928, index=0, id=929)
  sel.931: (bits[1], bits[8], bits[23]) = sel(not.925, cases=[__state_weight, tuple_index.930], id=931)
  tuple.932: (token, (bits[1], bits[8], bits[23])) = tuple(tuple_index.929, sel.931, id=932)
  weight_tok: token = tuple_index(tuple.932, index=0, id=933, pos=[(3,39,13)])
  receive.935: (token, (bits[1], bits[8], bits[23])) = receive(weight_tok, predicate=literal.920, channel=xls_systolic_4x4__east_west__1_2, id=935)
  receive.939: (token, (bits[1], bits[8], bits[23])) = receive(weight_tok, predicate=literal.920, channel=xls_systolic_4x4__north_south__1_2, id=939)
  __token: token = literal(value=token, id=918)
  activation: (bits[1], bits[8], bits[23]) = tuple_index(receive.935, index=1, id=938, pos=[(3,42,29)])
  weight: (bits[1], bits[8], bits[23]) = tuple_index(tuple.932, index=1, id=934, pos=[(3,39,25)])
  partial_sum: (bits[1], bits[8], bits[23]) = tuple_index(receive.939, index=1, id=942, pos=[(3,44,30)])
  invoke.944: (token, (bits[1], bits[8], bits[23])) = invoke(__token, literal.920, activation, weight, partial_sum, to_apply=__itok__float32__fma, id=944, pos=[(3,48,33)])
  result: (bits[1], bits[8], bits[23]) = tuple_index(invoke.944, index=1, id=946)
  activation_tok: token = tuple_index(receive.935, index=0, id=937, pos=[(3,42,13)])
  partial_sum_tok: token = tuple_index(receive.939, index=0, id=941, pos=[(3,44,13)])
  literal.962: bits[1] = literal(value=1, id=962, pos=[(3,55,36)])
  ROW: bits[32] = literal(value=1, id=921, pos=[(3,23,10)])
  COL: bits[32] = literal(value=2, id=922, pos=[(3,23,20)])
  tuple_index.947: bits[1] = tuple_index(activation, index=0, id=947)
  tuple_index.948: bits[8] = tuple_index(activation, index=1, id=948)
  tuple_index.949: bits[23] = tuple_index(activation, index=2, id=949)
  tuple_index.950: bits[1] = tuple_index(weight, index=0, id=950)
  tuple_index.951: bits[8] = tuple_index(weight, index=1, id=951)
  tuple_index.952: bits[23] = tuple_index(weight, index=2, id=952)
  tuple_index.953: bits[1] = tuple_index(partial_sum, index=0, id=953)
  tuple_index.954: bits[8] = tuple_index(partial_sum, index=1, id=954)
  tuple_index.955: bits[23] = tuple_index(partial_sum, index=2, id=955)
  tuple_index.956: bits[1] = tuple_index(result, index=0, id=956)
  tuple_index.957: bits[8] = tuple_index(result, index=1, id=957)
  tuple_index.958: bits[23] = tuple_index(result, index=2, id=958)
  input_tok: token = after_all(activation_tok, partial_sum_tok, id=943)
  tuple.963: (bits[1], (bits[1], bits[8], bits[23])) = tuple(literal.962, weight, id=963, pos=[(3,55,19)])
  tuple_index.936: token = tuple_index(receive.935, index=0, id=936)
  tuple_index.940: token = tuple_index(receive.939, index=0, id=940)
  tuple_index.945: token = tuple_index(invoke.944, index=0, id=945)
  trace.959: token = trace(__token, literal.920, format="node[{}, {}]: fma(activation=APFloat{{sign: {}, bexp: {}, fraction: {}}}, weight=APFloat{{sign: {}, bexp: {}, fraction: {}}}, partial_sum=APFloat{{sign: {}, bexp: {}, fraction: {}}}) = APFloat{{sign: {}, bexp: {}, fraction: {}}}", data_operands=[ROW, COL, tuple_index.947, tuple_index.948, tuple_index.949, tuple_index.950, tuple_index.951, tuple_index.952, tuple_index.953, tuple_index.954, tuple_index.955, tuple_index.956, tuple_index.957, tuple_index.958], id=959)
  send.960: token = send(input_tok, activation, predicate=literal.920, channel=xls_systolic_4x4__east_west__1_3, id=960)
  send.961: token = send(input_tok, result, predicate=literal.920, channel=xls_systolic_4x4__north_south__2_2, id=961)
  next_value.964: () = next_value(param=__state, value=tuple.963, id=964)
}

proc __xls_systolic_4x4__matmul_4x4__matmul_0__node_7__3_1_next(__state: (bits[1], (bits[1], bits[8], bits[23])), init={(0, (0, 255, 4194304))}) {
  __state: (bits[1], (bits[1], bits[8], bits[23])) = state_read(state_element=__state, id=966)
  __state_is_configured: bits[1] = tuple_index(__state, index=0, id=971, pos=[(3,40,48)])
  literal.967: bits[1] = literal(value=1, id=967)
  not.972: bits[1] = not(__state_is_configured, id=972, pos=[(3,40,42)])
  literal.970: token = literal(value=token, id=970)
  and.974: bits[1] = and(literal.967, not.972, id=974)
  receive.975: (token, (bits[1], bits[8], bits[23])) = receive(literal.970, predicate=and.974, channel=xls_systolic_4x4__node_weights__1_3, id=975)
  __state_weight: (bits[1], bits[8], bits[23]) = tuple_index(__state, index=1, id=973, pos=[(3,40,69)])
  tuple_index.977: (bits[1], bits[8], bits[23]) = tuple_index(receive.975, index=1, id=977)
  tuple_index.976: token = tuple_index(receive.975, index=0, id=976)
  sel.978: (bits[1], bits[8], bits[23]) = sel(not.972, cases=[__state_weight, tuple_index.977], id=978)
  tuple.979: (token, (bits[1], bits[8], bits[23])) = tuple(tuple_index.976, sel.978, id=979)
  weight_tok: token = tuple_index(tuple.979, index=0, id=980, pos=[(3,39,13)])
  receive.982: (token, (bits[1], bits[8], bits[23])) = receive(weight_tok, predicate=literal.967, channel=xls_systolic_4x4__east_west__1_3, id=982)
  receive.986: (token, (bits[1], bits[8], bits[23])) = receive(weight_tok, predicate=literal.967, channel=xls_systolic_4x4__north_south__1_3, id=986)
  __token: token = literal(value=token, id=965)
  activation: (bits[1], bits[8], bits[23]) = tuple_index(receive.982, index=1, id=985, pos=[(3,42,29)])
  weight: (bits[1], bits[8], bits[23]) = tuple_index(tuple.979, index=1, id=981, pos=[(3,39,25)])
  partial_sum: (bits[1], bits[8], bits[23]) = tuple_index(receive.986, index=1, id=989, pos=[(3,44,30)])
  invoke.991: (token, (bits[1], bits[8], bits[23])) = invoke(__token, literal.967, activation, weight, partial_sum, to_apply=__itok__float32__fma, id=991, pos=[(3,48,33)])
  result: (bits[1], bits[8], bits[23]) = tuple_index(invoke.991, index=1, id=993)
  activation_tok: token = tuple_index(receive.982, index=0, id=984, pos=[(3,42,13)])
  partial_sum_tok: token = tuple_index(receive.986, index=0, id=988, pos=[(3,44,13)])
  literal.1009: bits[1] = literal(value=1, id=1009, pos=[(3,55,36)])
  ROW: bits[32] = literal(value=1, id=968, pos=[(3,23,10)])
  COL: bits[32] = literal(value=3, id=969, pos=[(3,23,20)])
  tuple_index.994: bits[1] = tuple_index(activation, index=0, id=994)
  tuple_index.995: bits[8] = tuple_index(activation, index=1, id=995)
  tuple_index.996: bits[23] = tuple_index(activation, index=2, id=996)
  tuple_index.997: bits[1] = tuple_index(weight, index=0, id=997)
  tuple_index.998: bits[8] = tuple_index(weight, index=1, id=998)
  tuple_index.999: bits[23] = tuple_index(weight, index=2, id=999)
  tuple_index.1000: bits[1] = tuple_index(partial_sum, index=0, id=1000)
  tuple_index.1001: bits[8] = tuple_index(partial_sum, index=1, id=1001)
  tuple_index.1002: bits[23] = tuple_index(partial_sum, index=2, id=1002)
  tuple_index.1003: bits[1] = tuple_index(result, index=0, id=1003)
  tuple_index.1004: bits[8] = tuple_index(result, index=1, id=1004)
  tuple_index.1005: bits[23] = tuple_index(result, index=2, id=1005)
  input_tok: token = after_all(activation_tok, partial_sum_tok, id=990)
  tuple.1010: (bits[1], (bits[1], bits[8], bits[23])) = tuple(literal.1009, weight, id=1010, pos=[(3,55,19)])
  tuple_index.983: token = tuple_index(receive.982, index=0, id=983)
  tuple_index.987: token = tuple_index(receive.986, index=0, id=987)
  tuple_index.992: token = tuple_index(invoke.991, index=0, id=992)
  trace.1006: token = trace(__token, literal.967, format="node[{}, {}]: fma(activation=APFloat{{sign: {}, bexp: {}, fraction: {}}}, weight=APFloat{{sign: {}, bexp: {}, fraction: {}}}, partial_sum=APFloat{{sign: {}, bexp: {}, fraction: {}}}) = APFloat{{sign: {}, bexp: {}, fraction: {}}}", data_operands=[ROW, COL, tuple_index.994, tuple_index.995, tuple_index.996, tuple_index.997, tuple_index.998, tuple_index.999, tuple_index.1000, tuple_index.1001, tuple_index.1002, tuple_index.1003, tuple_index.1004, tuple_index.1005], id=1006)
  send.1007: token = send(input_tok, activation, predicate=literal.967, channel=xls_systolic_4x4__east_west__1_4, id=1007)
  send.1008: token = send(input_tok, result, predicate=literal.967, channel=xls_systolic_4x4__north_south__2_3, id=1008)
  next_value.1011: () = next_value(param=__state, value=tuple.1010, id=1011)
}

proc __xls_systolic_4x4__matmul_4x4__matmul_0__node_8__0_2_next(__state: (bits[1], (bits[1], bits[8], bits[23])), init={(0, (0, 255, 4194304))}) {
  __state: (bits[1], (bits[1], bits[8], bits[23])) = state_read(state_element=__state, id=1013)
  __state_is_configured: bits[1] = tuple_index(__state, index=0, id=1018, pos=[(3,40,48)])
  literal.1014: bits[1] = literal(value=1, id=1014)
  not.1019: bits[1] = not(__state_is_configured, id=1019, pos=[(3,40,42)])
  literal.1017: token = literal(value=token, id=1017)
  and.1021: bits[1] = and(literal.1014, not.1019, id=1021)
  receive.1022: (token, (bits[1], bits[8], bits[23])) = receive(literal.1017, predicate=and.1021, channel=xls_systolic_4x4__node_weights__2_0, id=1022)
  __state_weight: (bits[1], bits[8], bits[23]) = tuple_index(__state, index=1, id=1020, pos=[(3,40,69)])
  tuple_index.1024: (bits[1], bits[8], bits[23]) = tuple_index(receive.1022, index=1, id=1024)
  tuple_index.1023: token = tuple_index(receive.1022, index=0, id=1023)
  sel.1025: (bits[1], bits[8], bits[23]) = sel(not.1019, cases=[__state_weight, tuple_index.1024], id=1025)
  tuple.1026: (token, (bits[1], bits[8], bits[23])) = tuple(tuple_index.1023, sel.1025, id=1026)
  weight_tok: token = tuple_index(tuple.1026, index=0, id=1027, pos=[(3,39,13)])
  receive.1029: (token, (bits[1], bits[8], bits[23])) = receive(weight_tok, predicate=literal.1014, channel=xls_systolic_4x4__east_west__2_0, id=1029)
  receive.1033: (token, (bits[1], bits[8], bits[23])) = receive(weight_tok, predicate=literal.1014, channel=xls_systolic_4x4__north_south__2_0, id=1033)
  __token: token = literal(value=token, id=1012)
  activation: (bits[1], bits[8], bits[23]) = tuple_index(receive.1029, index=1, id=1032, pos=[(3,42,29)])
  weight: (bits[1], bits[8], bits[23]) = tuple_index(tuple.1026, index=1, id=1028, pos=[(3,39,25)])
  partial_sum: (bits[1], bits[8], bits[23]) = tuple_index(receive.1033, index=1, id=1036, pos=[(3,44,30)])
  invoke.1038: (token, (bits[1], bits[8], bits[23])) = invoke(__token, literal.1014, activation, weight, partial_sum, to_apply=__itok__float32__fma, id=1038, pos=[(3,48,33)])
  result: (bits[1], bits[8], bits[23]) = tuple_index(invoke.1038, index=1, id=1040)
  activation_tok: token = tuple_index(receive.1029, index=0, id=1031, pos=[(3,42,13)])
  partial_sum_tok: token = tuple_index(receive.1033, index=0, id=1035, pos=[(3,44,13)])
  literal.1056: bits[1] = literal(value=1, id=1056, pos=[(3,55,36)])
  ROW: bits[32] = literal(value=2, id=1015, pos=[(3,23,10)])
  COL: bits[32] = literal(value=0, id=1016, pos=[(3,23,20)])
  tuple_index.1041: bits[1] = tuple_index(activation, index=0, id=1041)
  tuple_index.1042: bits[8] = tuple_index(activation, index=1, id=1042)
  tuple_index.1043: bits[23] = tuple_index(activation, index=2, id=1043)
  tuple_index.1044: bits[1] = tuple_index(weight, index=0, id=1044)
  tuple_index.1045: bits[8] = tuple_index(weight, index=1, id=1045)
  tuple_index.1046: bits[23] = tuple_index(weight, index=2, id=1046)
  tuple_index.1047: bits[1] = tuple_index(partial_sum, index=0, id=1047)
  tuple_index.1048: bits[8] = tuple_index(partial_sum, index=1, id=1048)
  tuple_index.1049: bits[23] = tuple_index(partial_sum, index=2, id=1049)
  tuple_index.1050: bits[1] = tuple_index(result, index=0, id=1050)
  tuple_index.1051: bits[8] = tuple_index(result, index=1, id=1051)
  tuple_index.1052: bits[23] = tuple_index(result, index=2, id=1052)
  input_tok: token = after_all(activation_tok, partial_sum_tok, id=1037)
  tuple.1057: (bits[1], (bits[1], bits[8], bits[23])) = tuple(literal.1056, weight, id=1057, pos=[(3,55,19)])
  tuple_index.1030: token = tuple_index(receive.1029, index=0, id=1030)
  tuple_index.1034: token = tuple_index(receive.1033, index=0, id=1034)
  tuple_index.1039: token = tuple_index(invoke.1038, index=0, id=1039)
  trace.1053: token = trace(__token, literal.1014, format="node[{}, {}]: fma(activation=APFloat{{sign: {}, bexp: {}, fraction: {}}}, weight=APFloat{{sign: {}, bexp: {}, fraction: {}}}, partial_sum=APFloat{{sign: {}, bexp: {}, fraction: {}}}) = APFloat{{sign: {}, bexp: {}, fraction: {}}}", data_operands=[ROW, COL, tuple_index.1041, tuple_index.1042, tuple_index.1043, tuple_index.1044, tuple_index.1045, tuple_index.1046, tuple_index.1047, tuple_index.1048, tuple_index.1049, tuple_index.1050, tuple_index.1051, tuple_index.1052], id=1053)
  send.1054: token = send(input_tok, activation, predicate=literal.1014, channel=xls_systolic_4x4__east_west__2_1, id=1054)
  send.1055: token = send(input_tok, result, predicate=literal.1014, channel=xls_systolic_4x4__north_south__3_0, id=1055)
  next_value.1058: () = next_value(param=__state, value=tuple.1057, id=1058)
}

proc __xls_systolic_4x4__matmul_4x4__matmul_0__node_9__1_2_next(__state: (bits[1], (bits[1], bits[8], bits[23])), init={(0, (0, 255, 4194304))}) {
  __state: (bits[1], (bits[1], bits[8], bits[23])) = state_read(state_element=__state, id=1060)
  __state_is_configured: bits[1] = tuple_index(__state, index=0, id=1065, pos=[(3,40,48)])
  literal.1061: bits[1] = literal(value=1, id=1061)
  not.1066: bits[1] = not(__state_is_configured, id=1066, pos=[(3,40,42)])
  literal.1064: token = literal(value=token, id=1064)
  and.1068: bits[1] = and(literal.1061, not.1066, id=1068)
  receive.1069: (token, (bits[1], bits[8], bits[23])) = receive(literal.1064, predicate=and.1068, channel=xls_systolic_4x4__node_weights__2_1, id=1069)
  __state_weight: (bits[1], bits[8], bits[23]) = tuple_index(__state, index=1, id=1067, pos=[(3,40,69)])
  tuple_index.1071: (bits[1], bits[8], bits[23]) = tuple_index(receive.1069, index=1, id=1071)
  tuple_index.1070: token = tuple_index(receive.1069, index=0, id=1070)
  sel.1072: (bits[1], bits[8], bits[23]) = sel(not.1066, cases=[__state_weight, tuple_index.1071], id=1072)
  tuple.1073: (token, (bits[1], bits[8], bits[23])) = tuple(tuple_index.1070, sel.1072, id=1073)
  weight_tok: token = tuple_index(tuple.1073, index=0, id=1074, pos=[(3,39,13)])
  receive.1076: (token, (bits[1], bits[8], bits[23])) = receive(weight_tok, predicate=literal.1061, channel=xls_systolic_4x4__east_west__2_1, id=1076)
  receive.1080: (token, (bits[1], bits[8], bits[23])) = receive(weight_tok, predicate=literal.1061, channel=xls_systolic_4x4__north_south__2_1, id=1080)
  __token: token = literal(value=token, id=1059)
  activation: (bits[1], bits[8], bits[23]) = tuple_index(receive.1076, index=1, id=1079, pos=[(3,42,29)])
  weight: (bits[1], bits[8], bits[23]) = tuple_index(tuple.1073, index=1, id=1075, pos=[(3,39,25)])
  partial_sum: (bits[1], bits[8], bits[23]) = tuple_index(receive.1080, index=1, id=1083, pos=[(3,44,30)])
  invoke.1085: (token, (bits[1], bits[8], bits[23])) = invoke(__token, literal.1061, activation, weight, partial_sum, to_apply=__itok__float32__fma, id=1085, pos=[(3,48,33)])
  result: (bits[1], bits[8], bits[23]) = tuple_index(invoke.1085, index=1, id=1087)
  activation_tok: token = tuple_index(receive.1076, index=0, id=1078, pos=[(3,42,13)])
  partial_sum_tok: token = tuple_index(receive.1080, index=0, id=1082, pos=[(3,44,13)])
  literal.1103: bits[1] = literal(value=1, id=1103, pos=[(3,55,36)])
  ROW: bits[32] = literal(value=2, id=1062, pos=[(3,23,10)])
  COL: bits[32] = literal(value=1, id=1063, pos=[(3,23,20)])
  tuple_index.1088: bits[1] = tuple_index(activation, index=0, id=1088)
  tuple_index.1089: bits[8] = tuple_index(activation, index=1, id=1089)
  tuple_index.1090: bits[23] = tuple_index(activation, index=2, id=1090)
  tuple_index.1091: bits[1] = tuple_index(weight, index=0, id=1091)
  tuple_index.1092: bits[8] = tuple_index(weight, index=1, id=1092)
  tuple_index.1093: bits[23] = tuple_index(weight, index=2, id=1093)
  tuple_index.1094: bits[1] = tuple_index(partial_sum, index=0, id=1094)
  tuple_index.1095: bits[8] = tuple_index(partial_sum, index=1, id=1095)
  tuple_index.1096: bits[23] = tuple_index(partial_sum, index=2, id=1096)
  tuple_index.1097: bits[1] = tuple_index(result, index=0, id=1097)
  tuple_index.1098: bits[8] = tuple_index(result, index=1, id=1098)
  tuple_index.1099: bits[23] = tuple_index(result, index=2, id=1099)
  input_tok: token = after_all(activation_tok, partial_sum_tok, id=1084)
  tuple.1104: (bits[1], (bits[1], bits[8], bits[23])) = tuple(literal.1103, weight, id=1104, pos=[(3,55,19)])
  tuple_index.1077: token = tuple_index(receive.1076, index=0, id=1077)
  tuple_index.1081: token = tuple_index(receive.1080, index=0, id=1081)
  tuple_index.1086: token = tuple_index(invoke.1085, index=0, id=1086)
  trace.1100: token = trace(__token, literal.1061, format="node[{}, {}]: fma(activation=APFloat{{sign: {}, bexp: {}, fraction: {}}}, weight=APFloat{{sign: {}, bexp: {}, fraction: {}}}, partial_sum=APFloat{{sign: {}, bexp: {}, fraction: {}}}) = APFloat{{sign: {}, bexp: {}, fraction: {}}}", data_operands=[ROW, COL, tuple_index.1088, tuple_index.1089, tuple_index.1090, tuple_index.1091, tuple_index.1092, tuple_index.1093, tuple_index.1094, tuple_index.1095, tuple_index.1096, tuple_index.1097, tuple_index.1098, tuple_index.1099], id=1100)
  send.1101: token = send(input_tok, activation, predicate=literal.1061, channel=xls_systolic_4x4__east_west__2_2, id=1101)
  send.1102: token = send(input_tok, result, predicate=literal.1061, channel=xls_systolic_4x4__north_south__3_1, id=1102)
  next_value.1105: () = next_value(param=__state, value=tuple.1104, id=1105)
}

proc __xls_systolic_4x4__matmul_4x4__matmul_0__node_10__2_2_next(__state: (bits[1], (bits[1], bits[8], bits[23])), init={(0, (0, 255, 4194304))}) {
  __state: (bits[1], (bits[1], bits[8], bits[23])) = state_read(state_element=__state, id=1107)
  __state_is_configured: bits[1] = tuple_index(__state, index=0, id=1112, pos=[(3,40,48)])
  literal.1108: bits[1] = literal(value=1, id=1108)
  not.1113: bits[1] = not(__state_is_configured, id=1113, pos=[(3,40,42)])
  literal.1111: token = literal(value=token, id=1111)
  and.1115: bits[1] = and(literal.1108, not.1113, id=1115)
  receive.1116: (token, (bits[1], bits[8], bits[23])) = receive(literal.1111, predicate=and.1115, channel=xls_systolic_4x4__node_weights__2_2, id=1116)
  __state_weight: (bits[1], bits[8], bits[23]) = tuple_index(__state, index=1, id=1114, pos=[(3,40,69)])
  tuple_index.1118: (bits[1], bits[8], bits[23]) = tuple_index(receive.1116, index=1, id=1118)
  tuple_index.1117: token = tuple_index(receive.1116, index=0, id=1117)
  sel.1119: (bits[1], bits[8], bits[23]) = sel(not.1113, cases=[__state_weight, tuple_index.1118], id=1119)
  tuple.1120: (token, (bits[1], bits[8], bits[23])) = tuple(tuple_index.1117, sel.1119, id=1120)
  weight_tok: token = tuple_index(tuple.1120, index=0, id=1121, pos=[(3,39,13)])
  receive.1123: (token, (bits[1], bits[8], bits[23])) = receive(weight_tok, predicate=literal.1108, channel=xls_systolic_4x4__east_west__2_2, id=1123)
  receive.1127: (token, (bits[1], bits[8], bits[23])) = receive(weight_tok, predicate=literal.1108, channel=xls_systolic_4x4__north_south__2_2, id=1127)
  __token: token = literal(value=token, id=1106)
  activation: (bits[1], bits[8], bits[23]) = tuple_index(receive.1123, index=1, id=1126, pos=[(3,42,29)])
  weight: (bits[1], bits[8], bits[23]) = tuple_index(tuple.1120, index=1, id=1122, pos=[(3,39,25)])
  partial_sum: (bits[1], bits[8], bits[23]) = tuple_index(receive.1127, index=1, id=1130, pos=[(3,44,30)])
  invoke.1132: (token, (bits[1], bits[8], bits[23])) = invoke(__token, literal.1108, activation, weight, partial_sum, to_apply=__itok__float32__fma, id=1132, pos=[(3,48,33)])
  result: (bits[1], bits[8], bits[23]) = tuple_index(invoke.1132, index=1, id=1134)
  activation_tok: token = tuple_index(receive.1123, index=0, id=1125, pos=[(3,42,13)])
  partial_sum_tok: token = tuple_index(receive.1127, index=0, id=1129, pos=[(3,44,13)])
  literal.1150: bits[1] = literal(value=1, id=1150, pos=[(3,55,36)])
  ROW: bits[32] = literal(value=2, id=1109, pos=[(3,23,10)])
  COL: bits[32] = literal(value=2, id=1110, pos=[(3,23,20)])
  tuple_index.1135: bits[1] = tuple_index(activation, index=0, id=1135)
  tuple_index.1136: bits[8] = tuple_index(activation, index=1, id=1136)
  tuple_index.1137: bits[23] = tuple_index(activation, index=2, id=1137)
  tuple_index.1138: bits[1] = tuple_index(weight, index=0, id=1138)
  tuple_index.1139: bits[8] = tuple_index(weight, index=1, id=1139)
  tuple_index.1140: bits[23] = tuple_index(weight, index=2, id=1140)
  tuple_index.1141: bits[1] = tuple_index(partial_sum, index=0, id=1141)
  tuple_index.1142: bits[8] = tuple_index(partial_sum, index=1, id=1142)
  tuple_index.1143: bits[23] = tuple_index(partial_sum, index=2, id=1143)
  tuple_index.1144: bits[1] = tuple_index(result, index=0, id=1144)
  tuple_index.1145: bits[8] = tuple_index(result, index=1, id=1145)
  tuple_index.1146: bits[23] = tuple_index(result, index=2, id=1146)
  input_tok: token = after_all(activation_tok, partial_sum_tok, id=1131)
  tuple.1151: (bits[1], (bits[1], bits[8], bits[23])) = tuple(literal.1150, weight, id=1151, pos=[(3,55,19)])
  tuple_index.1124: token = tuple_index(receive.1123, index=0, id=1124)
  tuple_index.1128: token = tuple_index(receive.1127, index=0, id=1128)
  tuple_index.1133: token = tuple_index(invoke.1132, index=0, id=1133)
  trace.1147: token = trace(__token, literal.1108, format="node[{}, {}]: fma(activation=APFloat{{sign: {}, bexp: {}, fraction: {}}}, weight=APFloat{{sign: {}, bexp: {}, fraction: {}}}, partial_sum=APFloat{{sign: {}, bexp: {}, fraction: {}}}) = APFloat{{sign: {}, bexp: {}, fraction: {}}}", data_operands=[ROW, COL, tuple_index.1135, tuple_index.1136, tuple_index.1137, tuple_index.1138, tuple_index.1139, tuple_index.1140, tuple_index.1141, tuple_index.1142, tuple_index.1143, tuple_index.1144, tuple_index.1145, tuple_index.1146], id=1147)
  send.1148: token = send(input_tok, activation, predicate=literal.1108, channel=xls_systolic_4x4__east_west__2_3, id=1148)
  send.1149: token = send(input_tok, result, predicate=literal.1108, channel=xls_systolic_4x4__north_south__3_2, id=1149)
  next_value.1152: () = next_value(param=__state, value=tuple.1151, id=1152)
}

proc __xls_systolic_4x4__matmul_4x4__matmul_0__node_11__3_2_next(__state: (bits[1], (bits[1], bits[8], bits[23])), init={(0, (0, 255, 4194304))}) {
  __state: (bits[1], (bits[1], bits[8], bits[23])) = state_read(state_element=__state, id=1154)
  __state_is_configured: bits[1] = tuple_index(__state, index=0, id=1159, pos=[(3,40,48)])
  literal.1155: bits[1] = literal(value=1, id=1155)
  not.1160: bits[1] = not(__state_is_configured, id=1160, pos=[(3,40,42)])
  literal.1158: token = literal(value=token, id=1158)
  and.1162: bits[1] = and(literal.1155, not.1160, id=1162)
  receive.1163: (token, (bits[1], bits[8], bits[23])) = receive(literal.1158, predicate=and.1162, channel=xls_systolic_4x4__node_weights__2_3, id=1163)
  __state_weight: (bits[1], bits[8], bits[23]) = tuple_index(__state, index=1, id=1161, pos=[(3,40,69)])
  tuple_index.1165: (bits[1], bits[8], bits[23]) = tuple_index(receive.1163, index=1, id=1165)
  tuple_index.1164: token = tuple_index(receive.1163, index=0, id=1164)
  sel.1166: (bits[1], bits[8], bits[23]) = sel(not.1160, cases=[__state_weight, tuple_index.1165], id=1166)
  tuple.1167: (token, (bits[1], bits[8], bits[23])) = tuple(tuple_index.1164, sel.1166, id=1167)
  weight_tok: token = tuple_index(tuple.1167, index=0, id=1168, pos=[(3,39,13)])
  receive.1170: (token, (bits[1], bits[8], bits[23])) = receive(weight_tok, predicate=literal.1155, channel=xls_systolic_4x4__east_west__2_3, id=1170)
  receive.1174: (token, (bits[1], bits[8], bits[23])) = receive(weight_tok, predicate=literal.1155, channel=xls_systolic_4x4__north_south__2_3, id=1174)
  __token: token = literal(value=token, id=1153)
  activation: (bits[1], bits[8], bits[23]) = tuple_index(receive.1170, index=1, id=1173, pos=[(3,42,29)])
  weight: (bits[1], bits[8], bits[23]) = tuple_index(tuple.1167, index=1, id=1169, pos=[(3,39,25)])
  partial_sum: (bits[1], bits[8], bits[23]) = tuple_index(receive.1174, index=1, id=1177, pos=[(3,44,30)])
  invoke.1179: (token, (bits[1], bits[8], bits[23])) = invoke(__token, literal.1155, activation, weight, partial_sum, to_apply=__itok__float32__fma, id=1179, pos=[(3,48,33)])
  result: (bits[1], bits[8], bits[23]) = tuple_index(invoke.1179, index=1, id=1181)
  activation_tok: token = tuple_index(receive.1170, index=0, id=1172, pos=[(3,42,13)])
  partial_sum_tok: token = tuple_index(receive.1174, index=0, id=1176, pos=[(3,44,13)])
  literal.1197: bits[1] = literal(value=1, id=1197, pos=[(3,55,36)])
  ROW: bits[32] = literal(value=2, id=1156, pos=[(3,23,10)])
  COL: bits[32] = literal(value=3, id=1157, pos=[(3,23,20)])
  tuple_index.1182: bits[1] = tuple_index(activation, index=0, id=1182)
  tuple_index.1183: bits[8] = tuple_index(activation, index=1, id=1183)
  tuple_index.1184: bits[23] = tuple_index(activation, index=2, id=1184)
  tuple_index.1185: bits[1] = tuple_index(weight, index=0, id=1185)
  tuple_index.1186: bits[8] = tuple_index(weight, index=1, id=1186)
  tuple_index.1187: bits[23] = tuple_index(weight, index=2, id=1187)
  tuple_index.1188: bits[1] = tuple_index(partial_sum, index=0, id=1188)
  tuple_index.1189: bits[8] = tuple_index(partial_sum, index=1, id=1189)
  tuple_index.1190: bits[23] = tuple_index(partial_sum, index=2, id=1190)
  tuple_index.1191: bits[1] = tuple_index(result, index=0, id=1191)
  tuple_index.1192: bits[8] = tuple_index(result, index=1, id=1192)
  tuple_index.1193: bits[23] = tuple_index(result, index=2, id=1193)
  input_tok: token = after_all(activation_tok, partial_sum_tok, id=1178)
  tuple.1198: (bits[1], (bits[1], bits[8], bits[23])) = tuple(literal.1197, weight, id=1198, pos=[(3,55,19)])
  tuple_index.1171: token = tuple_index(receive.1170, index=0, id=1171)
  tuple_index.1175: token = tuple_index(receive.1174, index=0, id=1175)
  tuple_index.1180: token = tuple_index(invoke.1179, index=0, id=1180)
  trace.1194: token = trace(__token, literal.1155, format="node[{}, {}]: fma(activation=APFloat{{sign: {}, bexp: {}, fraction: {}}}, weight=APFloat{{sign: {}, bexp: {}, fraction: {}}}, partial_sum=APFloat{{sign: {}, bexp: {}, fraction: {}}}) = APFloat{{sign: {}, bexp: {}, fraction: {}}}", data_operands=[ROW, COL, tuple_index.1182, tuple_index.1183, tuple_index.1184, tuple_index.1185, tuple_index.1186, tuple_index.1187, tuple_index.1188, tuple_index.1189, tuple_index.1190, tuple_index.1191, tuple_index.1192, tuple_index.1193], id=1194)
  send.1195: token = send(input_tok, activation, predicate=literal.1155, channel=xls_systolic_4x4__east_west__2_4, id=1195)
  send.1196: token = send(input_tok, result, predicate=literal.1155, channel=xls_systolic_4x4__north_south__3_3, id=1196)
  next_value.1199: () = next_value(param=__state, value=tuple.1198, id=1199)
}

proc __xls_systolic_4x4__matmul_4x4__matmul_0__node_12__0_3_next(__state: (bits[1], (bits[1], bits[8], bits[23])), init={(0, (0, 255, 4194304))}) {
  __state: (bits[1], (bits[1], bits[8], bits[23])) = state_read(state_element=__state, id=1201)
  __state_is_configured: bits[1] = tuple_index(__state, index=0, id=1206, pos=[(3,40,48)])
  literal.1202: bits[1] = literal(value=1, id=1202)
  not.1207: bits[1] = not(__state_is_configured, id=1207, pos=[(3,40,42)])
  literal.1205: token = literal(value=token, id=1205)
  and.1209: bits[1] = and(literal.1202, not.1207, id=1209)
  receive.1210: (token, (bits[1], bits[8], bits[23])) = receive(literal.1205, predicate=and.1209, channel=xls_systolic_4x4__node_weights__3_0, id=1210)
  __state_weight: (bits[1], bits[8], bits[23]) = tuple_index(__state, index=1, id=1208, pos=[(3,40,69)])
  tuple_index.1212: (bits[1], bits[8], bits[23]) = tuple_index(receive.1210, index=1, id=1212)
  tuple_index.1211: token = tuple_index(receive.1210, index=0, id=1211)
  sel.1213: (bits[1], bits[8], bits[23]) = sel(not.1207, cases=[__state_weight, tuple_index.1212], id=1213)
  tuple.1214: (token, (bits[1], bits[8], bits[23])) = tuple(tuple_index.1211, sel.1213, id=1214)
  weight_tok: token = tuple_index(tuple.1214, index=0, id=1215, pos=[(3,39,13)])
  receive.1217: (token, (bits[1], bits[8], bits[23])) = receive(weight_tok, predicate=literal.1202, channel=xls_systolic_4x4__east_west__3_0, id=1217)
  receive.1221: (token, (bits[1], bits[8], bits[23])) = receive(weight_tok, predicate=literal.1202, channel=xls_systolic_4x4__north_south__3_0, id=1221)
  __token: token = literal(value=token, id=1200)
  activation: (bits[1], bits[8], bits[23]) = tuple_index(receive.1217, index=1, id=1220, pos=[(3,42,29)])
  weight: (bits[1], bits[8], bits[23]) = tuple_index(tuple.1214, index=1, id=1216, pos=[(3,39,25)])
  partial_sum: (bits[1], bits[8], bits[23]) = tuple_index(receive.1221, index=1, id=1224, pos=[(3,44,30)])
  invoke.1226: (token, (bits[1], bits[8], bits[23])) = invoke(__token, literal.1202, activation, weight, partial_sum, to_apply=__itok__float32__fma, id=1226, pos=[(3,48,33)])
  result: (bits[1], bits[8], bits[23]) = tuple_index(invoke.1226, index=1, id=1228)
  activation_tok: token = tuple_index(receive.1217, index=0, id=1219, pos=[(3,42,13)])
  partial_sum_tok: token = tuple_index(receive.1221, index=0, id=1223, pos=[(3,44,13)])
  literal.1244: bits[1] = literal(value=1, id=1244, pos=[(3,55,36)])
  ROW: bits[32] = literal(value=3, id=1203, pos=[(3,23,10)])
  COL: bits[32] = literal(value=0, id=1204, pos=[(3,23,20)])
  tuple_index.1229: bits[1] = tuple_index(activation, index=0, id=1229)
  tuple_index.1230: bits[8] = tuple_index(activation, index=1, id=1230)
  tuple_index.1231: bits[23] = tuple_index(activation, index=2, id=1231)
  tuple_index.1232: bits[1] = tuple_index(weight, index=0, id=1232)
  tuple_index.1233: bits[8] = tuple_index(weight, index=1, id=1233)
  tuple_index.1234: bits[23] = tuple_index(weight, index=2, id=1234)
  tuple_index.1235: bits[1] = tuple_index(partial_sum, index=0, id=1235)
  tuple_index.1236: bits[8] = tuple_index(partial_sum, index=1, id=1236)
  tuple_index.1237: bits[23] = tuple_index(partial_sum, index=2, id=1237)
  tuple_index.1238: bits[1] = tuple_index(result, index=0, id=1238)
  tuple_index.1239: bits[8] = tuple_index(result, index=1, id=1239)
  tuple_index.1240: bits[23] = tuple_index(result, index=2, id=1240)
  input_tok: token = after_all(activation_tok, partial_sum_tok, id=1225)
  tuple.1245: (bits[1], (bits[1], bits[8], bits[23])) = tuple(literal.1244, weight, id=1245, pos=[(3,55,19)])
  tuple_index.1218: token = tuple_index(receive.1217, index=0, id=1218)
  tuple_index.1222: token = tuple_index(receive.1221, index=0, id=1222)
  tuple_index.1227: token = tuple_index(invoke.1226, index=0, id=1227)
  trace.1241: token = trace(__token, literal.1202, format="node[{}, {}]: fma(activation=APFloat{{sign: {}, bexp: {}, fraction: {}}}, weight=APFloat{{sign: {}, bexp: {}, fraction: {}}}, partial_sum=APFloat{{sign: {}, bexp: {}, fraction: {}}}) = APFloat{{sign: {}, bexp: {}, fraction: {}}}", data_operands=[ROW, COL, tuple_index.1229, tuple_index.1230, tuple_index.1231, tuple_index.1232, tuple_index.1233, tuple_index.1234, tuple_index.1235, tuple_index.1236, tuple_index.1237, tuple_index.1238, tuple_index.1239, tuple_index.1240], id=1241)
  send.1242: token = send(input_tok, activation, predicate=literal.1202, channel=xls_systolic_4x4__east_west__3_1, id=1242)
  send.1243: token = send(input_tok, result, predicate=literal.1202, channel=xls_systolic_4x4__north_south__4_0, id=1243)
  next_value.1246: () = next_value(param=__state, value=tuple.1245, id=1246)
}

proc __xls_systolic_4x4__matmul_4x4__matmul_0__node_13__1_3_next(__state: (bits[1], (bits[1], bits[8], bits[23])), init={(0, (0, 255, 4194304))}) {
  __state: (bits[1], (bits[1], bits[8], bits[23])) = state_read(state_element=__state, id=1248)
  __state_is_configured: bits[1] = tuple_index(__state, index=0, id=1253, pos=[(3,40,48)])
  literal.1249: bits[1] = literal(value=1, id=1249)
  not.1254: bits[1] = not(__state_is_configured, id=1254, pos=[(3,40,42)])
  literal.1252: token = literal(value=token, id=1252)
  and.1256: bits[1] = and(literal.1249, not.1254, id=1256)
  receive.1257: (token, (bits[1], bits[8], bits[23])) = receive(literal.1252, predicate=and.1256, channel=xls_systolic_4x4__node_weights__3_1, id=1257)
  __state_weight: (bits[1], bits[8], bits[23]) = tuple_index(__state, index=1, id=1255, pos=[(3,40,69)])
  tuple_index.1259: (bits[1], bits[8], bits[23]) = tuple_index(receive.1257, index=1, id=1259)
  tuple_index.1258: token = tuple_index(receive.1257, index=0, id=1258)
  sel.1260: (bits[1], bits[8], bits[23]) = sel(not.1254, cases=[__state_weight, tuple_index.1259], id=1260)
  tuple.1261: (token, (bits[1], bits[8], bits[23])) = tuple(tuple_index.1258, sel.1260, id=1261)
  weight_tok: token = tuple_index(tuple.1261, index=0, id=1262, pos=[(3,39,13)])
  receive.1264: (token, (bits[1], bits[8], bits[23])) = receive(weight_tok, predicate=literal.1249, channel=xls_systolic_4x4__east_west__3_1, id=1264)
  receive.1268: (token, (bits[1], bits[8], bits[23])) = receive(weight_tok, predicate=literal.1249, channel=xls_systolic_4x4__north_south__3_1, id=1268)
  __token: token = literal(value=token, id=1247)
  activation: (bits[1], bits[8], bits[23]) = tuple_index(receive.1264, index=1, id=1267, pos=[(3,42,29)])
  weight: (bits[1], bits[8], bits[23]) = tuple_index(tuple.1261, index=1, id=1263, pos=[(3,39,25)])
  partial_sum: (bits[1], bits[8], bits[23]) = tuple_index(receive.1268, index=1, id=1271, pos=[(3,44,30)])
  invoke.1273: (token, (bits[1], bits[8], bits[23])) = invoke(__token, literal.1249, activation, weight, partial_sum, to_apply=__itok__float32__fma, id=1273, pos=[(3,48,33)])
  result: (bits[1], bits[8], bits[23]) = tuple_index(invoke.1273, index=1, id=1275)
  activation_tok: token = tuple_index(receive.1264, index=0, id=1266, pos=[(3,42,13)])
  partial_sum_tok: token = tuple_index(receive.1268, index=0, id=1270, pos=[(3,44,13)])
  literal.1291: bits[1] = literal(value=1, id=1291, pos=[(3,55,36)])
  ROW: bits[32] = literal(value=3, id=1250, pos=[(3,23,10)])
  COL: bits[32] = literal(value=1, id=1251, pos=[(3,23,20)])
  tuple_index.1276: bits[1] = tuple_index(activation, index=0, id=1276)
  tuple_index.1277: bits[8] = tuple_index(activation, index=1, id=1277)
  tuple_index.1278: bits[23] = tuple_index(activation, index=2, id=1278)
  tuple_index.1279: bits[1] = tuple_index(weight, index=0, id=1279)
  tuple_index.1280: bits[8] = tuple_index(weight, index=1, id=1280)
  tuple_index.1281: bits[23] = tuple_index(weight, index=2, id=1281)
  tuple_index.1282: bits[1] = tuple_index(partial_sum, index=0, id=1282)
  tuple_index.1283: bits[8] = tuple_index(partial_sum, index=1, id=1283)
  tuple_index.1284: bits[23] = tuple_index(partial_sum, index=2, id=1284)
  tuple_index.1285: bits[1] = tuple_index(result, index=0, id=1285)
  tuple_index.1286: bits[8] = tuple_index(result, index=1, id=1286)
  tuple_index.1287: bits[23] = tuple_index(result, index=2, id=1287)
  input_tok: token = after_all(activation_tok, partial_sum_tok, id=1272)
  tuple.1292: (bits[1], (bits[1], bits[8], bits[23])) = tuple(literal.1291, weight, id=1292, pos=[(3,55,19)])
  tuple_index.1265: token = tuple_index(receive.1264, index=0, id=1265)
  tuple_index.1269: token = tuple_index(receive.1268, index=0, id=1269)
  tuple_index.1274: token = tuple_index(invoke.1273, index=0, id=1274)
  trace.1288: token = trace(__token, literal.1249, format="node[{}, {}]: fma(activation=APFloat{{sign: {}, bexp: {}, fraction: {}}}, weight=APFloat{{sign: {}, bexp: {}, fraction: {}}}, partial_sum=APFloat{{sign: {}, bexp: {}, fraction: {}}}) = APFloat{{sign: {}, bexp: {}, fraction: {}}}", data_operands=[ROW, COL, tuple_index.1276, tuple_index.1277, tuple_index.1278, tuple_index.1279, tuple_index.1280, tuple_index.1281, tuple_index.1282, tuple_index.1283, tuple_index.1284, tuple_index.1285, tuple_index.1286, tuple_index.1287], id=1288)
  send.1289: token = send(input_tok, activation, predicate=literal.1249, channel=xls_systolic_4x4__east_west__3_2, id=1289)
  send.1290: token = send(input_tok, result, predicate=literal.1249, channel=xls_systolic_4x4__north_south__4_1, id=1290)
  next_value.1293: () = next_value(param=__state, value=tuple.1292, id=1293)
}

proc __xls_systolic_4x4__matmul_4x4__matmul_0__node_14__2_3_next(__state: (bits[1], (bits[1], bits[8], bits[23])), init={(0, (0, 255, 4194304))}) {
  __state: (bits[1], (bits[1], bits[8], bits[23])) = state_read(state_element=__state, id=1295)
  __state_is_configured: bits[1] = tuple_index(__state, index=0, id=1300, pos=[(3,40,48)])
  literal.1296: bits[1] = literal(value=1, id=1296)
  not.1301: bits[1] = not(__state_is_configured, id=1301, pos=[(3,40,42)])
  literal.1299: token = literal(value=token, id=1299)
  and.1303: bits[1] = and(literal.1296, not.1301, id=1303)
  receive.1304: (token, (bits[1], bits[8], bits[23])) = receive(literal.1299, predicate=and.1303, channel=xls_systolic_4x4__node_weights__3_2, id=1304)
  __state_weight: (bits[1], bits[8], bits[23]) = tuple_index(__state, index=1, id=1302, pos=[(3,40,69)])
  tuple_index.1306: (bits[1], bits[8], bits[23]) = tuple_index(receive.1304, index=1, id=1306)
  tuple_index.1305: token = tuple_index(receive.1304, index=0, id=1305)
  sel.1307: (bits[1], bits[8], bits[23]) = sel(not.1301, cases=[__state_weight, tuple_index.1306], id=1307)
  tuple.1308: (token, (bits[1], bits[8], bits[23])) = tuple(tuple_index.1305, sel.1307, id=1308)
  weight_tok: token = tuple_index(tuple.1308, index=0, id=1309, pos=[(3,39,13)])
  receive.1311: (token, (bits[1], bits[8], bits[23])) = receive(weight_tok, predicate=literal.1296, channel=xls_systolic_4x4__east_west__3_2, id=1311)
  receive.1315: (token, (bits[1], bits[8], bits[23])) = receive(weight_tok, predicate=literal.1296, channel=xls_systolic_4x4__north_south__3_2, id=1315)
  __token: token = literal(value=token, id=1294)
  activation: (bits[1], bits[8], bits[23]) = tuple_index(receive.1311, index=1, id=1314, pos=[(3,42,29)])
  weight: (bits[1], bits[8], bits[23]) = tuple_index(tuple.1308, index=1, id=1310, pos=[(3,39,25)])
  partial_sum: (bits[1], bits[8], bits[23]) = tuple_index(receive.1315, index=1, id=1318, pos=[(3,44,30)])
  invoke.1320: (token, (bits[1], bits[8], bits[23])) = invoke(__token, literal.1296, activation, weight, partial_sum, to_apply=__itok__float32__fma, id=1320, pos=[(3,48,33)])
  result: (bits[1], bits[8], bits[23]) = tuple_index(invoke.1320, index=1, id=1322)
  activation_tok: token = tuple_index(receive.1311, index=0, id=1313, pos=[(3,42,13)])
  partial_sum_tok: token = tuple_index(receive.1315, index=0, id=1317, pos=[(3,44,13)])
  literal.1338: bits[1] = literal(value=1, id=1338, pos=[(3,55,36)])
  ROW: bits[32] = literal(value=3, id=1297, pos=[(3,23,10)])
  COL: bits[32] = literal(value=2, id=1298, pos=[(3,23,20)])
  tuple_index.1323: bits[1] = tuple_index(activation, index=0, id=1323)
  tuple_index.1324: bits[8] = tuple_index(activation, index=1, id=1324)
  tuple_index.1325: bits[23] = tuple_index(activation, index=2, id=1325)
  tuple_index.1326: bits[1] = tuple_index(weight, index=0, id=1326)
  tuple_index.1327: bits[8] = tuple_index(weight, index=1, id=1327)
  tuple_index.1328: bits[23] = tuple_index(weight, index=2, id=1328)
  tuple_index.1329: bits[1] = tuple_index(partial_sum, index=0, id=1329)
  tuple_index.1330: bits[8] = tuple_index(partial_sum, index=1, id=1330)
  tuple_index.1331: bits[23] = tuple_index(partial_sum, index=2, id=1331)
  tuple_index.1332: bits[1] = tuple_index(result, index=0, id=1332)
  tuple_index.1333: bits[8] = tuple_index(result, index=1, id=1333)
  tuple_index.1334: bits[23] = tuple_index(result, index=2, id=1334)
  input_tok: token = after_all(activation_tok, partial_sum_tok, id=1319)
  tuple.1339: (bits[1], (bits[1], bits[8], bits[23])) = tuple(literal.1338, weight, id=1339, pos=[(3,55,19)])
  tuple_index.1312: token = tuple_index(receive.1311, index=0, id=1312)
  tuple_index.1316: token = tuple_index(receive.1315, index=0, id=1316)
  tuple_index.1321: token = tuple_index(invoke.1320, index=0, id=1321)
  trace.1335: token = trace(__token, literal.1296, format="node[{}, {}]: fma(activation=APFloat{{sign: {}, bexp: {}, fraction: {}}}, weight=APFloat{{sign: {}, bexp: {}, fraction: {}}}, partial_sum=APFloat{{sign: {}, bexp: {}, fraction: {}}}) = APFloat{{sign: {}, bexp: {}, fraction: {}}}", data_operands=[ROW, COL, tuple_index.1323, tuple_index.1324, tuple_index.1325, tuple_index.1326, tuple_index.1327, tuple_index.1328, tuple_index.1329, tuple_index.1330, tuple_index.1331, tuple_index.1332, tuple_index.1333, tuple_index.1334], id=1335)
  send.1336: token = send(input_tok, activation, predicate=literal.1296, channel=xls_systolic_4x4__east_west__3_3, id=1336)
  send.1337: token = send(input_tok, result, predicate=literal.1296, channel=xls_systolic_4x4__north_south__4_2, id=1337)
  next_value.1340: () = next_value(param=__state, value=tuple.1339, id=1340)
}

proc __xls_systolic_4x4__matmul_4x4__matmul_0__node_15__3_3_next(__state: (bits[1], (bits[1], bits[8], bits[23])), init={(0, (0, 255, 4194304))}) {
  __state: (bits[1], (bits[1], bits[8], bits[23])) = state_read(state_element=__state, id=1342)
  __state_is_configured: bits[1] = tuple_index(__state, index=0, id=1347, pos=[(3,40,48)])
  literal.1343: bits[1] = literal(value=1, id=1343)
  not.1348: bits[1] = not(__state_is_configured, id=1348, pos=[(3,40,42)])
  literal.1346: token = literal(value=token, id=1346)
  and.1350: bits[1] = and(literal.1343, not.1348, id=1350)
  receive.1351: (token, (bits[1], bits[8], bits[23])) = receive(literal.1346, predicate=and.1350, channel=xls_systolic_4x4__node_weights__3_3, id=1351)
  __state_weight: (bits[1], bits[8], bits[23]) = tuple_index(__state, index=1, id=1349, pos=[(3,40,69)])
  tuple_index.1353: (bits[1], bits[8], bits[23]) = tuple_index(receive.1351, index=1, id=1353)
  tuple_index.1352: token = tuple_index(receive.1351, index=0, id=1352)
  sel.1354: (bits[1], bits[8], bits[23]) = sel(not.1348, cases=[__state_weight, tuple_index.1353], id=1354)
  tuple.1355: (token, (bits[1], bits[8], bits[23])) = tuple(tuple_index.1352, sel.1354, id=1355)
  weight_tok: token = tuple_index(tuple.1355, index=0, id=1356, pos=[(3,39,13)])
  receive.1358: (token, (bits[1], bits[8], bits[23])) = receive(weight_tok, predicate=literal.1343, channel=xls_systolic_4x4__east_west__3_3, id=1358)
  receive.1362: (token, (bits[1], bits[8], bits[23])) = receive(weight_tok, predicate=literal.1343, channel=xls_systolic_4x4__north_south__3_3, id=1362)
  __token: token = literal(value=token, id=1341)
  activation: (bits[1], bits[8], bits[23]) = tuple_index(receive.1358, index=1, id=1361, pos=[(3,42,29)])
  weight: (bits[1], bits[8], bits[23]) = tuple_index(tuple.1355, index=1, id=1357, pos=[(3,39,25)])
  partial_sum: (bits[1], bits[8], bits[23]) = tuple_index(receive.1362, index=1, id=1365, pos=[(3,44,30)])
  invoke.1367: (token, (bits[1], bits[8], bits[23])) = invoke(__token, literal.1343, activation, weight, partial_sum, to_apply=__itok__float32__fma, id=1367, pos=[(3,48,33)])
  result: (bits[1], bits[8], bits[23]) = tuple_index(invoke.1367, index=1, id=1369)
  activation_tok: token = tuple_index(receive.1358, index=0, id=1360, pos=[(3,42,13)])
  partial_sum_tok: token = tuple_index(receive.1362, index=0, id=1364, pos=[(3,44,13)])
  literal.1385: bits[1] = literal(value=1, id=1385, pos=[(3,55,36)])
  ROW: bits[32] = literal(value=3, id=1344, pos=[(3,23,10)])
  COL: bits[32] = literal(value=3, id=1345, pos=[(3,23,20)])
  tuple_index.1370: bits[1] = tuple_index(activation, index=0, id=1370)
  tuple_index.1371: bits[8] = tuple_index(activation, index=1, id=1371)
  tuple_index.1372: bits[23] = tuple_index(activation, index=2, id=1372)
  tuple_index.1373: bits[1] = tuple_index(weight, index=0, id=1373)
  tuple_index.1374: bits[8] = tuple_index(weight, index=1, id=1374)
  tuple_index.1375: bits[23] = tuple_index(weight, index=2, id=1375)
  tuple_index.1376: bits[1] = tuple_index(partial_sum, index=0, id=1376)
  tuple_index.1377: bits[8] = tuple_index(partial_sum, index=1, id=1377)
  tuple_index.1378: bits[23] = tuple_index(partial_sum, index=2, id=1378)
  tuple_index.1379: bits[1] = tuple_index(result, index=0, id=1379)
  tuple_index.1380: bits[8] = tuple_index(result, index=1, id=1380)
  tuple_index.1381: bits[23] = tuple_index(result, index=2, id=1381)
  input_tok: token = after_all(activation_tok, partial_sum_tok, id=1366)
  tuple.1386: (bits[1], (bits[1], bits[8], bits[23])) = tuple(literal.1385, weight, id=1386, pos=[(3,55,19)])
  tuple_index.1359: token = tuple_index(receive.1358, index=0, id=1359)
  tuple_index.1363: token = tuple_index(receive.1362, index=0, id=1363)
  tuple_index.1368: token = tuple_index(invoke.1367, index=0, id=1368)
  trace.1382: token = trace(__token, literal.1343, format="node[{}, {}]: fma(activation=APFloat{{sign: {}, bexp: {}, fraction: {}}}, weight=APFloat{{sign: {}, bexp: {}, fraction: {}}}, partial_sum=APFloat{{sign: {}, bexp: {}, fraction: {}}}) = APFloat{{sign: {}, bexp: {}, fraction: {}}}", data_operands=[ROW, COL, tuple_index.1370, tuple_index.1371, tuple_index.1372, tuple_index.1373, tuple_index.1374, tuple_index.1375, tuple_index.1376, tuple_index.1377, tuple_index.1378, tuple_index.1379, tuple_index.1380, tuple_index.1381], id=1382)
  send.1383: token = send(input_tok, activation, predicate=literal.1343, channel=xls_systolic_4x4__east_west__3_4, id=1383)
  send.1384: token = send(input_tok, result, predicate=literal.1343, channel=xls_systolic_4x4__north_south__4_3, id=1384)
  next_value.1387: () = next_value(param=__state, value=tuple.1386, id=1387)
}

fn __apfloat__zero__8_23(sign: bits[1] id=621) -> (bits[1], bits[8], bits[23]) {
  literal.624: bits[8] = literal(value=0, id=624, pos=[(1,131,47)])
  literal.625: bits[23] = literal(value=0, id=625, pos=[(1,131,73)])
  EXP_SZ: bits[32] = literal(value=8, id=622, pos=[(1,130,12)])
  FRACTION_SZ: bits[32] = literal(value=23, id=623, pos=[(1,130,25)])
  ret tuple.626: (bits[1], bits[8], bits[23]) = tuple(sign, literal.624, literal.625, id=626, pos=[(1,131,33)])
}

fn __float32__zero(sign: bits[1] id=627) -> (bits[1], bits[8], bits[23]) {
  F32_EXP_SZ: bits[32] = literal(value=8, id=628, pos=[(2,18,23)])
  F32_FRACTION_SZ: bits[32] = literal(value=23, id=629, pos=[(2,19,28)])
  ret invoke.630: (bits[1], bits[8], bits[23]) = invoke(sign, to_apply=__apfloat__zero__8_23, id=630, pos=[(2,39,44)])
}

proc __xls_systolic_4x4__matmul_4x4__matmul_0__4_4_next(__state: bits[1], init={0}) {
  __state: bits[1] = state_read(state_element=__state, id=1389)
  literal.1390: bits[1] = literal(value=1, id=1390)
  not.1393: bits[1] = not(__state, id=1393, pos=[(3,95,21)])
  literal.1394: token = literal(value=token, id=1394)
  and.1395: bits[1] = and(literal.1390, not.1393, id=1395)
  receive.1396: (token, (bits[1], bits[8], bits[23])[4][4]) = receive(literal.1394, predicate=and.1395, channel=xls_systolic_4x4__weights, id=1396)
  weights_matrix: (bits[1], bits[8], bits[23])[4][4] = tuple_index(receive.1396, index=1, id=1399, pos=[(3,96,35)])
  row: bits[32] = literal(value=0, id=1401, pos=[(3,97,52)])
  array_index.1403: (bits[1], bits[8], bits[23])[4] = array_index(weights_matrix, indices=[row], id=1403, pos=[(3,100,85)])
  col: bits[32] = literal(value=0, id=1402, pos=[(3,98,56)])
  array_index.1409: (bits[1], bits[8], bits[23])[4] = array_index(weights_matrix, indices=[row], id=1409, pos=[(3,100,85)])
  col__1: bits[32] = literal(value=1, id=1408, pos=[(3,98,56)])
  recv_weights_tok: token = tuple_index(receive.1396, index=0, id=1398, pos=[(3,96,17)])
  array_index.1404: (bits[1], bits[8], bits[23]) = array_index(array_index.1403, indices=[col], id=1404, pos=[(3,100,90)])
  and.1405: bits[1] = and(literal.1390, not.1393, id=1405)
  array_index.1415: (bits[1], bits[8], bits[23])[4] = array_index(weights_matrix, indices=[row], id=1415, pos=[(3,100,85)])
  col__2: bits[32] = literal(value=2, id=1414, pos=[(3,98,56)])
  array_index.1410: (bits[1], bits[8], bits[23]) = array_index(array_index.1409, indices=[col__1], id=1410, pos=[(3,100,90)])
  and.1411: bits[1] = and(literal.1390, not.1393, id=1411)
  weight_tok: token = send(recv_weights_tok, array_index.1404, predicate=and.1405, channel=xls_systolic_4x4__node_weights__0_0, id=1406)
  tok__1: token = literal(value=token, id=1400)
  row__1: bits[32] = literal(value=1, id=1426, pos=[(3,97,52)])
  array_index.1421: (bits[1], bits[8], bits[23])[4] = array_index(weights_matrix, indices=[row], id=1421, pos=[(3,100,85)])
  col__3: bits[32] = literal(value=3, id=1420, pos=[(3,98,56)])
  array_index.1416: (bits[1], bits[8], bits[23]) = array_index(array_index.1415, indices=[col__2], id=1416, pos=[(3,100,90)])
  and.1417: bits[1] = and(literal.1390, not.1393, id=1417)
  weight_tok__1: token = send(recv_weights_tok, array_index.1410, predicate=and.1411, channel=xls_systolic_4x4__node_weights__0_1, id=1412)
  tok__2: token = after_all(weight_tok, tok__1, id=1407)
  array_index.1428: (bits[1], bits[8], bits[23])[4] = array_index(weights_matrix, indices=[row__1], id=1428, pos=[(3,100,85)])
  col__4: bits[32] = literal(value=0, id=1427, pos=[(3,98,56)])
  array_index.1422: (bits[1], bits[8], bits[23]) = array_index(array_index.1421, indices=[col__3], id=1422, pos=[(3,100,90)])
  and.1423: bits[1] = and(literal.1390, not.1393, id=1423)
  weight_tok__2: token = send(recv_weights_tok, array_index.1416, predicate=and.1417, channel=xls_systolic_4x4__node_weights__0_2, id=1418)
  tok__3: token = after_all(weight_tok__1, tok__2, id=1413)
  array_index.1434: (bits[1], bits[8], bits[23])[4] = array_index(weights_matrix, indices=[row__1], id=1434, pos=[(3,100,85)])
  col__5: bits[32] = literal(value=1, id=1433, pos=[(3,98,56)])
  array_index.1429: (bits[1], bits[8], bits[23]) = array_index(array_index.1428, indices=[col__4], id=1429, pos=[(3,100,90)])
  and.1430: bits[1] = and(literal.1390, not.1393, id=1430)
  weight_tok__3: token = send(recv_weights_tok, array_index.1422, predicate=and.1423, channel=xls_systolic_4x4__node_weights__0_3, id=1424)
  tok__4: token = after_all(weight_tok__2, tok__3, id=1419)
  array_index.1440: (bits[1], bits[8], bits[23])[4] = array_index(weights_matrix, indices=[row__1], id=1440, pos=[(3,100,85)])
  col__6: bits[32] = literal(value=2, id=1439, pos=[(3,98,56)])
  array_index.1435: (bits[1], bits[8], bits[23]) = array_index(array_index.1434, indices=[col__5], id=1435, pos=[(3,100,90)])
  and.1436: bits[1] = and(literal.1390, not.1393, id=1436)
  weight_tok__4: token = send(recv_weights_tok, array_index.1429, predicate=and.1430, channel=xls_systolic_4x4__node_weights__1_0, id=1431)
  tok__6: token = after_all(weight_tok__3, tok__4, id=1425)
  row__2: bits[32] = literal(value=2, id=1451, pos=[(3,97,52)])
  array_index.1446: (bits[1], bits[8], bits[23])[4] = array_index(weights_matrix, indices=[row__1], id=1446, pos=[(3,100,85)])
  col__7: bits[32] = literal(value=3, id=1445, pos=[(3,98,56)])
  array_index.1441: (bits[1], bits[8], bits[23]) = array_index(array_index.1440, indices=[col__6], id=1441, pos=[(3,100,90)])
  and.1442: bits[1] = and(literal.1390, not.1393, id=1442)
  weight_tok__5: token = send(recv_weights_tok, array_index.1435, predicate=and.1436, channel=xls_systolic_4x4__node_weights__1_1, id=1437)
  tok__7: token = after_all(weight_tok__4, tok__6, id=1432)
  array_index.1453: (bits[1], bits[8], bits[23])[4] = array_index(weights_matrix, indices=[row__2], id=1453, pos=[(3,100,85)])
  col__8: bits[32] = literal(value=0, id=1452, pos=[(3,98,56)])
  array_index.1447: (bits[1], bits[8], bits[23]) = array_index(array_index.1446, indices=[col__7], id=1447, pos=[(3,100,90)])
  and.1448: bits[1] = and(literal.1390, not.1393, id=1448)
  weight_tok__6: token = send(recv_weights_tok, array_index.1441, predicate=and.1442, channel=xls_systolic_4x4__node_weights__1_2, id=1443)
  tok__8: token = after_all(weight_tok__5, tok__7, id=1438)
  array_index.1459: (bits[1], bits[8], bits[23])[4] = array_index(weights_matrix, indices=[row__2], id=1459, pos=[(3,100,85)])
  col__9: bits[32] = literal(value=1, id=1458, pos=[(3,98,56)])
  array_index.1454: (bits[1], bits[8], bits[23]) = array_index(array_index.1453, indices=[col__8], id=1454, pos=[(3,100,90)])
  and.1455: bits[1] = and(literal.1390, not.1393, id=1455)
  weight_tok__7: token = send(recv_weights_tok, array_index.1447, predicate=and.1448, channel=xls_systolic_4x4__node_weights__1_3, id=1449)
  tok__9: token = after_all(weight_tok__6, tok__8, id=1444)
  array_index.1465: (bits[1], bits[8], bits[23])[4] = array_index(weights_matrix, indices=[row__2], id=1465, pos=[(3,100,85)])
  col__10: bits[32] = literal(value=2, id=1464, pos=[(3,98,56)])
  array_index.1460: (bits[1], bits[8], bits[23]) = array_index(array_index.1459, indices=[col__9], id=1460, pos=[(3,100,90)])
  and.1461: bits[1] = and(literal.1390, not.1393, id=1461)
  weight_tok__8: token = send(recv_weights_tok, array_index.1454, predicate=and.1455, channel=xls_systolic_4x4__node_weights__2_0, id=1456)
  tok__11: token = after_all(weight_tok__7, tok__9, id=1450)
  row__3: bits[32] = literal(value=3, id=1476, pos=[(3,97,52)])
  array_index.1471: (bits[1], bits[8], bits[23])[4] = array_index(weights_matrix, indices=[row__2], id=1471, pos=[(3,100,85)])
  col__11: bits[32] = literal(value=3, id=1470, pos=[(3,98,56)])
  array_index.1466: (bits[1], bits[8], bits[23]) = array_index(array_index.1465, indices=[col__10], id=1466, pos=[(3,100,90)])
  and.1467: bits[1] = and(literal.1390, not.1393, id=1467)
  weight_tok__9: token = send(recv_weights_tok, array_index.1460, predicate=and.1461, channel=xls_systolic_4x4__node_weights__2_1, id=1462)
  tok__12: token = after_all(weight_tok__8, tok__11, id=1457)
  array_index.1478: (bits[1], bits[8], bits[23])[4] = array_index(weights_matrix, indices=[row__3], id=1478, pos=[(3,100,85)])
  col__12: bits[32] = literal(value=0, id=1477, pos=[(3,98,56)])
  array_index.1472: (bits[1], bits[8], bits[23]) = array_index(array_index.1471, indices=[col__11], id=1472, pos=[(3,100,90)])
  and.1473: bits[1] = and(literal.1390, not.1393, id=1473)
  weight_tok__10: token = send(recv_weights_tok, array_index.1466, predicate=and.1467, channel=xls_systolic_4x4__node_weights__2_2, id=1468)
  tok__13: token = after_all(weight_tok__9, tok__12, id=1463)
  array_index.1484: (bits[1], bits[8], bits[23])[4] = array_index(weights_matrix, indices=[row__3], id=1484, pos=[(3,100,85)])
  col__13: bits[32] = literal(value=1, id=1483, pos=[(3,98,56)])
  array_index.1479: (bits[1], bits[8], bits[23]) = array_index(array_index.1478, indices=[col__12], id=1479, pos=[(3,100,90)])
  and.1480: bits[1] = and(literal.1390, not.1393, id=1480)
  weight_tok__11: token = send(recv_weights_tok, array_index.1472, predicate=and.1473, channel=xls_systolic_4x4__node_weights__2_3, id=1474)
  tok__14: token = after_all(weight_tok__10, tok__13, id=1469)
  array_index.1490: (bits[1], bits[8], bits[23])[4] = array_index(weights_matrix, indices=[row__3], id=1490, pos=[(3,100,85)])
  col__14: bits[32] = literal(value=2, id=1489, pos=[(3,98,56)])
  array_index.1485: (bits[1], bits[8], bits[23]) = array_index(array_index.1484, indices=[col__13], id=1485, pos=[(3,100,90)])
  and.1486: bits[1] = and(literal.1390, not.1393, id=1486)
  weight_tok__12: token = send(recv_weights_tok, array_index.1479, predicate=and.1480, channel=xls_systolic_4x4__node_weights__3_0, id=1481)
  tok__16: token = after_all(weight_tok__11, tok__14, id=1475)
  array_index.1496: (bits[1], bits[8], bits[23])[4] = array_index(weights_matrix, indices=[row__3], id=1496, pos=[(3,100,85)])
  col__15: bits[32] = literal(value=3, id=1495, pos=[(3,98,56)])
  array_index.1491: (bits[1], bits[8], bits[23]) = array_index(array_index.1490, indices=[col__14], id=1491, pos=[(3,100,90)])
  and.1492: bits[1] = and(literal.1390, not.1393, id=1492)
  weight_tok__13: token = send(recv_weights_tok, array_index.1485, predicate=and.1486, channel=xls_systolic_4x4__node_weights__3_1, id=1487)
  tok__17: token = after_all(weight_tok__12, tok__16, id=1482)
  array_index.1497: (bits[1], bits[8], bits[23]) = array_index(array_index.1496, indices=[col__15], id=1497, pos=[(3,100,90)])
  and.1498: bits[1] = and(literal.1390, not.1393, id=1498)
  weight_tok__14: token = send(recv_weights_tok, array_index.1491, predicate=and.1492, channel=xls_systolic_4x4__node_weights__3_2, id=1493)
  tok__18: token = after_all(weight_tok__13, tok__17, id=1488)
  weight_tok__15: token = send(recv_weights_tok, array_index.1497, predicate=and.1498, channel=xls_systolic_4x4__node_weights__3_3, id=1499)
  tok__19: token = after_all(weight_tok__14, tok__18, id=1494)
  literal.1501: token = literal(value=token, id=1501)
  after_all.1500: token = after_all(weight_tok__15, tok__19, id=1500)
  tok__20: token = sel(not.1393, cases=[literal.1501, after_all.1500], id=1502, pos=[(3,95,18)])
  literal.1569: token = literal(value=token, id=1569)
  literal.1576: token = literal(value=token, id=1576)
  literal.1583: token = literal(value=token, id=1583)
  literal.1590: token = literal(value=token, id=1590)
  receive.1505: (token, (bits[1], bits[8], bits[23])) = receive(tok__20, predicate=literal.1390, channel=xls_systolic_4x4__activations__0, id=1505)
  receive.1511: (token, (bits[1], bits[8], bits[23])) = receive(tok__20, predicate=literal.1390, channel=xls_systolic_4x4__activations__1, id=1511)
  receive.1517: (token, (bits[1], bits[8], bits[23])) = receive(tok__20, predicate=literal.1390, channel=xls_systolic_4x4__activations__2, id=1517)
  receive.1523: (token, (bits[1], bits[8], bits[23])) = receive(tok__20, predicate=literal.1390, channel=xls_systolic_4x4__activations__3, id=1523)
  literal.1532: bits[1] = literal(value=0, id=1532, pos=[(3,118,68)])
  literal.1537: bits[1] = literal(value=0, id=1537, pos=[(3,118,68)])
  literal.1542: bits[1] = literal(value=0, id=1542, pos=[(3,118,68)])
  literal.1547: bits[1] = literal(value=0, id=1547, pos=[(3,118,68)])
  literal.1552: token = literal(value=token, id=1552)
  literal.1556: token = literal(value=token, id=1556)
  literal.1560: token = literal(value=token, id=1560)
  literal.1564: token = literal(value=token, id=1564)
  receive.1570: (token, (bits[1], bits[8], bits[23])) = receive(literal.1569, predicate=literal.1390, channel=xls_systolic_4x4__north_south__4_0, id=1570)
  receive.1577: (token, (bits[1], bits[8], bits[23])) = receive(literal.1576, predicate=literal.1390, channel=xls_systolic_4x4__north_south__4_1, id=1577)
  receive.1584: (token, (bits[1], bits[8], bits[23])) = receive(literal.1583, predicate=literal.1390, channel=xls_systolic_4x4__north_south__4_2, id=1584)
  receive.1591: (token, (bits[1], bits[8], bits[23])) = receive(literal.1590, predicate=literal.1390, channel=xls_systolic_4x4__north_south__4_3, id=1591)
  tok__21: token = tuple_index(receive.1505, index=0, id=1507, pos=[(3,111,17)])
  activation: (bits[1], bits[8], bits[23]) = tuple_index(receive.1505, index=1, id=1508, pos=[(3,111,22)])
  tok__22: token = tuple_index(receive.1511, index=0, id=1513, pos=[(3,111,17)])
  activation__1: (bits[1], bits[8], bits[23]) = tuple_index(receive.1511, index=1, id=1514, pos=[(3,111,22)])
  tok__23: token = tuple_index(receive.1517, index=0, id=1519, pos=[(3,111,17)])
  activation__2: (bits[1], bits[8], bits[23]) = tuple_index(receive.1517, index=1, id=1520, pos=[(3,111,22)])
  tok__24: token = tuple_index(receive.1523, index=0, id=1525, pos=[(3,111,17)])
  activation__3: (bits[1], bits[8], bits[23]) = tuple_index(receive.1523, index=1, id=1526, pos=[(3,111,22)])
  literal.1531: token = literal(value=token, id=1531)
  invoke.1533: (bits[1], bits[8], bits[23]) = invoke(literal.1532, to_apply=__float32__zero, id=1533, pos=[(3,118,67)])
  literal.1536: token = literal(value=token, id=1536)
  invoke.1538: (bits[1], bits[8], bits[23]) = invoke(literal.1537, to_apply=__float32__zero, id=1538, pos=[(3,118,67)])
  literal.1541: token = literal(value=token, id=1541)
  invoke.1543: (bits[1], bits[8], bits[23]) = invoke(literal.1542, to_apply=__float32__zero, id=1543, pos=[(3,118,67)])
  literal.1546: token = literal(value=token, id=1546)
  invoke.1548: (bits[1], bits[8], bits[23]) = invoke(literal.1547, to_apply=__float32__zero, id=1548, pos=[(3,118,67)])
  receive.1553: (token, (bits[1], bits[8], bits[23])) = receive(literal.1552, predicate=literal.1390, channel=xls_systolic_4x4__east_west__0_4, id=1553)
  receive.1557: (token, (bits[1], bits[8], bits[23])) = receive(literal.1556, predicate=literal.1390, channel=xls_systolic_4x4__east_west__1_4, id=1557)
  receive.1561: (token, (bits[1], bits[8], bits[23])) = receive(literal.1560, predicate=literal.1390, channel=xls_systolic_4x4__east_west__2_4, id=1561)
  receive.1565: (token, (bits[1], bits[8], bits[23])) = receive(literal.1564, predicate=literal.1390, channel=xls_systolic_4x4__east_west__3_4, id=1565)
  tok__25: token = tuple_index(receive.1570, index=0, id=1572, pos=[(3,130,17)])
  result: (bits[1], bits[8], bits[23]) = tuple_index(receive.1570, index=1, id=1573, pos=[(3,130,22)])
  tok__26: token = tuple_index(receive.1577, index=0, id=1579, pos=[(3,130,17)])
  result__1: (bits[1], bits[8], bits[23]) = tuple_index(receive.1577, index=1, id=1580, pos=[(3,130,22)])
  tok__27: token = tuple_index(receive.1584, index=0, id=1586, pos=[(3,130,17)])
  result__2: (bits[1], bits[8], bits[23]) = tuple_index(receive.1584, index=1, id=1587, pos=[(3,130,22)])
  tok__28: token = tuple_index(receive.1591, index=0, id=1593, pos=[(3,130,17)])
  result__3: (bits[1], bits[8], bits[23]) = tuple_index(receive.1591, index=1, id=1594, pos=[(3,130,22)])
  literal.1597: bits[1] = literal(value=1, id=1597, pos=[(3,134,8)])
  __token: token = literal(value=token, id=1388)
  RESULTS_ROW: bits[32] = literal(value=4, id=1391, pos=[(3,60,12)])
  DROPS_COL: bits[32] = literal(value=4, id=1392, pos=[(3,60,23)])
  tuple_index.1397: token = tuple_index(receive.1396, index=0, id=1397)
  ACTIVATIONS_COL: bits[32] = literal(value=0, id=1503, pos=[(3,109,32)])
  row__4: bits[32] = literal(value=0, id=1504, pos=[(3,110,43)])
  tuple_index.1506: token = tuple_index(receive.1505, index=0, id=1506)
  send.1509: token = send(tok__21, activation, predicate=literal.1390, channel=xls_systolic_4x4__east_west__0_0, id=1509)
  row__5: bits[32] = literal(value=1, id=1510, pos=[(3,110,43)])
  tuple_index.1512: token = tuple_index(receive.1511, index=0, id=1512)
  send.1515: token = send(tok__22, activation__1, predicate=literal.1390, channel=xls_systolic_4x4__east_west__1_0, id=1515)
  row__6: bits[32] = literal(value=2, id=1516, pos=[(3,110,43)])
  tuple_index.1518: token = tuple_index(receive.1517, index=0, id=1518)
  send.1521: token = send(tok__23, activation__2, predicate=literal.1390, channel=xls_systolic_4x4__east_west__2_0, id=1521)
  row__7: bits[32] = literal(value=3, id=1522, pos=[(3,110,43)])
  tuple_index.1524: token = tuple_index(receive.1523, index=0, id=1524)
  send.1527: token = send(tok__24, activation__3, predicate=literal.1390, channel=xls_systolic_4x4__east_west__3_0, id=1527)
  tuple.1528: () = tuple(id=1528, pos=[(3,110,8)])
  ZEROES_ROW: bits[32] = literal(value=0, id=1529, pos=[(3,116,27)])
  col__16: bits[32] = literal(value=0, id=1530, pos=[(3,117,43)])
  send.1534: token = send(literal.1531, invoke.1533, predicate=literal.1390, channel=xls_systolic_4x4__north_south__0_0, id=1534)
  col__17: bits[32] = literal(value=1, id=1535, pos=[(3,117,43)])
  send.1539: token = send(literal.1536, invoke.1538, predicate=literal.1390, channel=xls_systolic_4x4__north_south__0_1, id=1539)
  col__18: bits[32] = literal(value=2, id=1540, pos=[(3,117,43)])
  send.1544: token = send(literal.1541, invoke.1543, predicate=literal.1390, channel=xls_systolic_4x4__north_south__0_2, id=1544)
  col__19: bits[32] = literal(value=3, id=1545, pos=[(3,117,43)])
  send.1549: token = send(literal.1546, invoke.1548, predicate=literal.1390, channel=xls_systolic_4x4__north_south__0_3, id=1549)
  tuple.1550: () = tuple(id=1550, pos=[(3,117,8)])
  row__8: bits[32] = literal(value=0, id=1551, pos=[(3,123,43)])
  tuple_index.1554: token = tuple_index(receive.1553, index=0, id=1554)
  row__9: bits[32] = literal(value=1, id=1555, pos=[(3,123,43)])
  tuple_index.1558: token = tuple_index(receive.1557, index=0, id=1558)
  row__10: bits[32] = literal(value=2, id=1559, pos=[(3,123,43)])
  tuple_index.1562: token = tuple_index(receive.1561, index=0, id=1562)
  row__11: bits[32] = literal(value=3, id=1563, pos=[(3,123,43)])
  tuple_index.1566: token = tuple_index(receive.1565, index=0, id=1566)
  tuple.1567: () = tuple(id=1567, pos=[(3,123,8)])
  col__20: bits[32] = literal(value=0, id=1568, pos=[(3,129,43)])
  tuple_index.1571: token = tuple_index(receive.1570, index=0, id=1571)
  send.1574: token = send(tok__25, result, predicate=literal.1390, channel=xls_systolic_4x4__results__0, id=1574)
  col__21: bits[32] = literal(value=1, id=1575, pos=[(3,129,43)])
  tuple_index.1578: token = tuple_index(receive.1577, index=0, id=1578)
  send.1581: token = send(tok__26, result__1, predicate=literal.1390, channel=xls_systolic_4x4__results__1, id=1581)
  col__22: bits[32] = literal(value=2, id=1582, pos=[(3,129,43)])
  tuple_index.1585: token = tuple_index(receive.1584, index=0, id=1585)
  send.1588: token = send(tok__27, result__2, predicate=literal.1390, channel=xls_systolic_4x4__results__2, id=1588)
  col__23: bits[32] = literal(value=3, id=1589, pos=[(3,129,43)])
  tuple_index.1592: token = tuple_index(receive.1591, index=0, id=1592)
  send.1595: token = send(tok__28, result__3, predicate=literal.1390, channel=xls_systolic_4x4__results__3, id=1595)
  tuple.1596: () = tuple(id=1596, pos=[(3,129,8)])
  next_value.1598: () = next_value(param=__state, value=literal.1597, id=1598)
}
